import{a as ke,b as Ve}from"./chunk-P4POYZ4U.js";import{b as Fe,c as qe}from"./chunk-PA6GOXPW.js";import{$e as j,$f as Qe,Ab as we,Cc as Pe,Db as P,Eb as U,Ga as N,Ha as ue,Ib as Ee,Jb as Re,Kb as ye,Le as xe,Ma as G,Qa as F,Re as W,Tb as Ie,Te as K,V as ce,Va as A,Xa as B,Xf as Be,Y as te,aa as H,ab as I,af as Le,ba as Y,bb as E,bc as Se,ca as ne,cb as R,cf as Z,db as z,dc as be,df as J,eb as ge,fb as pe,fc as _e,gb as V,gc as h,hb as fe,hc as ie,ib as he,ja as k,ka as $,kb as X,ld as Te,m as le,mb as q,mg as Oe,ob as S,ra as de,sb as Ce,tb as ze,ua as me,ub as ve,wb as oe,wf as Ae,xb as Ne,ya as w,yb as Me,zb as De}from"./chunk-MEWDXWWM.js";var at=["canvas"],rt=["image"];function lt(s,d){if(s&1&&V(0,"img",3,1),s&2){let e=S();F("src",e.icon(),me)}}function ct(s,d){if(s&1&&(ne(),V(0,"image",2)),s&2){let e,i,l,m,r,p=S();F("href",(e=p.imageSettings())==null?null:e.src)("height",(i=p.calculatedImageSettings())==null?null:i.h)("width",(l=p.calculatedImageSettings())==null?null:l.w)("x",p.getImageX())("y",p.getImageY())("opacity",(m=p.calculatedImageSettings())==null?null:m.opacity)("crossOrigin",(r=p.calculatedImageSettings())==null?null:r.crossOrigin)}}var dt=()=>({x:0,y:0,h:0,w:0,excavation:null,opacity:1,crossOrigin:""});function mt(s,d){if(s&1&&(fe(0),P(1),he()),s&2){let e=S(2);w(),U(e.nzStatusRender())}}function ut(s,d){if(s&1&&(E(0,"div",0),G(1,mt,2,1,"ng-container",1),R()),s&2){let e=S();w(),I("nzStringTemplateOutlet",e.nzStatusRender())}}function gt(s,d){s&1&&z(0,"nz-spin")}function pt(s,d){if(s&1){let e=X();E(0,"div")(1,"p",2),P(2),R(),E(3,"button",3),q("click",function(){H(e);let l=S(2);return Y(l.reloadQRCode())}),z(4,"nz-icon",4),E(5,"span"),P(6),R()()()}if(s&2){let e=S(2);w(2),U(e.locale().expired),w(4),U(e.locale().refresh)}}function ft(s,d){if(s&1&&(E(0,"div")(1,"p",2),P(2),R()()),s&2){let e=S(2);w(2),U(e.locale().scanned)}}function ht(s,d){if(s&1&&(E(0,"div",0),A(1,gt,1,0,"nz-spin")(2,pt,7,2,"div")(3,ft,3,1,"div"),R()),s&2){let e,i=S();w(),B((e=i.nzStatus())==="loading"?1:e==="expired"?2:e==="scanned"?3:-1)}}function Ct(s,d){if(s&1&&z(0,"nz-qrcode-canvas",5),s&2){let e=S(2);I("icon",e.nzIcon())("margin",e.margin())("cells",e.cells())("numCells",e.numCells())("calculatedImageSettings",e.calculatedImageSettings())("size",e.nzSize())("color",e.nzColor())("bgColor",e.nzBgColor())}}function zt(s,d){if(s&1&&z(0,"nz-qrcode-svg",6),s&2){let e=S(2);I("color",e.nzColor())("bgColor",e.nzBgColor())("icon",e.nzIcon())("margin",e.margin())("cells",e.cells())("numCells",e.numCells())("imageSettings",e.imageSettings())("calculatedImageSettings",e.calculatedImageSettings()||Ie(9,dt))("size",e.nzSize())}}function vt(s,d){if(s&1&&A(0,Ct,1,8,"nz-qrcode-canvas",5)(1,zt,1,10,"nz-qrcode-svg",6),s&2){let e,i=S();B((e=i.nzType())==="canvas"?0:e==="svg"?1:-1)}}var Q;(function(s){let d=(()=>{class r{version;errorCorrectionLevel;static encodeText(t,n){let o=s.QrSegment.makeSegments(t);return r.encodeSegments(o,n)}static encodeBinary(t,n){let o=s.QrSegment.makeBytes(t);return r.encodeSegments([o],n)}static encodeSegments(t,n,o=1,a=40,c=-1,g=!0){if(!(r.MIN_VERSION<=o&&o<=a&&a<=r.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");let u,C;for(u=o;;u++){let v=r.getNumDataCodewords(u,n)*8,y=m.getTotalBits(t,u);if(y<=v){C=y;break}if(u>=a)throw new RangeError("Data too long")}for(let v of[r.Ecc.MEDIUM,r.Ecc.QUARTILE,r.Ecc.HIGH])g&&C<=r.getNumDataCodewords(u,v)*8&&(n=v);let f=[];for(let v of t){e(v.mode.modeBits,4,f),e(v.numChars,v.mode.numCharCountBits(u),f);for(let y of v.getData())f.push(y)}l(f.length==C);let L=r.getNumDataCodewords(u,n)*8;l(f.length<=L),e(0,Math.min(4,L-f.length),f),e(0,(8-f.length%8)%8,f),l(f.length%8==0);for(let v=236;f.length<L;v^=253)e(v,8,f);let x=[];for(;x.length*8<f.length;)x.push(0);return f.forEach((v,y)=>x[y>>>3]|=v<<7-(y&7)),new r(u,n,x,c)}size;mask;modules=[];isFunction=[];constructor(t,n,o,a){if(this.version=t,this.errorCorrectionLevel=n,t<r.MIN_VERSION||t>r.MAX_VERSION)throw new RangeError("Version value out of range");if(a<-1||a>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let c=[];for(let u=0;u<this.size;u++)c.push(!1);for(let u=0;u<this.size;u++)this.modules.push(c.slice()),this.isFunction.push(c.slice());this.drawFunctionPatterns();let g=this.addEccAndInterleave(o);if(this.drawCodewords(g),a==-1){let u=1e9;for(let C=0;C<8;C++){this.applyMask(C),this.drawFormatBits(C);let f=this.getPenaltyScore();f<u&&(a=C,u=f),this.applyMask(C)}}l(a>=0&&a<=7),this.mask=a,this.applyMask(a),this.drawFormatBits(a),this.isFunction=[]}getModule(t,n){return t>=0&&t<this.size&&n>=0&&n<this.size&&this.modules[n][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let o=0;o<this.size;o++)this.setFunctionModule(6,o,o%2==0),this.setFunctionModule(o,6,o%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let t=this.getAlignmentPatternPositions(),n=t.length;for(let o=0;o<n;o++)for(let a=0;a<n;a++)o==0&&a==0||o==0&&a==n-1||o==n-1&&a==0||this.drawAlignmentPattern(t[o],t[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){let n=this.errorCorrectionLevel.formatBits<<3|t,o=n;for(let c=0;c<10;c++)o=o<<1^(o>>>9)*1335;let a=(n<<10|o)^21522;l(a>>>15==0);for(let c=0;c<=5;c++)this.setFunctionModule(8,c,i(a,c));this.setFunctionModule(8,7,i(a,6)),this.setFunctionModule(8,8,i(a,7)),this.setFunctionModule(7,8,i(a,8));for(let c=9;c<15;c++)this.setFunctionModule(14-c,8,i(a,c));for(let c=0;c<8;c++)this.setFunctionModule(this.size-1-c,8,i(a,c));for(let c=8;c<15;c++)this.setFunctionModule(8,this.size-15+c,i(a,c));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let o=0;o<12;o++)t=t<<1^(t>>>11)*7973;let n=this.version<<12|t;l(n>>>18==0);for(let o=0;o<18;o++){let a=i(n,o),c=this.size-11+o%3,g=Math.floor(o/3);this.setFunctionModule(c,g,a),this.setFunctionModule(g,c,a)}}drawFinderPattern(t,n){for(let o=-4;o<=4;o++)for(let a=-4;a<=4;a++){let c=Math.max(Math.abs(a),Math.abs(o)),g=t+a,u=n+o;g>=0&&g<this.size&&u>=0&&u<this.size&&this.setFunctionModule(g,u,c!=2&&c!=4)}}drawAlignmentPattern(t,n){for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++)this.setFunctionModule(t+a,n+o,Math.max(Math.abs(a),Math.abs(o))!=1)}setFunctionModule(t,n,o){this.modules[n][t]=o,this.isFunction[n][t]=!0}addEccAndInterleave(t){let n=this.version,o=this.errorCorrectionLevel;if(t.length!=r.getNumDataCodewords(n,o))throw new RangeError("Invalid argument");let a=r.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][n],c=r.ECC_CODEWORDS_PER_BLOCK[o.ordinal][n],g=Math.floor(r.getNumRawDataModules(n)/8),u=a-g%a,C=Math.floor(g/a),f=[],L=r.reedSolomonComputeDivisor(c);for(let v=0,y=0;v<a;v++){let O=t.slice(y,y+C-c+(v<u?0:1));y+=O.length;let nt=r.reedSolomonComputeRemainder(O,L);v<u&&O.push(0),f.push(O.concat(nt))}let x=[];for(let v=0;v<f[0].length;v++)f.forEach((y,O)=>{(v!=C-c||O>=u)&&x.push(y[v])});return l(x.length==g),x}drawCodewords(t){if(t.length!=Math.floor(r.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let o=this.size-1;o>=1;o-=2){o==6&&(o=5);for(let a=0;a<this.size;a++)for(let c=0;c<2;c++){let g=o-c,C=(o+1&2)==0?this.size-1-a:a;!this.isFunction[C][g]&&n<t.length*8&&(this.modules[C][g]=i(t[n>>>3],7-(n&7)),n++)}}l(n==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let n=0;n<this.size;n++)for(let o=0;o<this.size;o++){let a;switch(t){case 0:a=(o+n)%2==0;break;case 1:a=n%2==0;break;case 2:a=o%3==0;break;case 3:a=(o+n)%3==0;break;case 4:a=(Math.floor(o/3)+Math.floor(n/2))%2==0;break;case 5:a=o*n%2+o*n%3==0;break;case 6:a=(o*n%2+o*n%3)%2==0;break;case 7:a=((o+n)%2+o*n%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[n][o]&&a&&(this.modules[n][o]=!this.modules[n][o])}}getPenaltyScore(){let t=0;for(let c=0;c<this.size;c++){let g=!1,u=0,C=[0,0,0,0,0,0,0];for(let f=0;f<this.size;f++)this.modules[c][f]==g?(u++,u==5?t+=r.PENALTY_N1:u>5&&t++):(this.finderPenaltyAddHistory(u,C),g||(t+=this.finderPenaltyCountPatterns(C)*r.PENALTY_N3),g=this.modules[c][f],u=1);t+=this.finderPenaltyTerminateAndCount(g,u,C)*r.PENALTY_N3}for(let c=0;c<this.size;c++){let g=!1,u=0,C=[0,0,0,0,0,0,0];for(let f=0;f<this.size;f++)this.modules[f][c]==g?(u++,u==5?t+=r.PENALTY_N1:u>5&&t++):(this.finderPenaltyAddHistory(u,C),g||(t+=this.finderPenaltyCountPatterns(C)*r.PENALTY_N3),g=this.modules[f][c],u=1);t+=this.finderPenaltyTerminateAndCount(g,u,C)*r.PENALTY_N3}for(let c=0;c<this.size-1;c++)for(let g=0;g<this.size-1;g++){let u=this.modules[c][g];u==this.modules[c][g+1]&&u==this.modules[c+1][g]&&u==this.modules[c+1][g+1]&&(t+=r.PENALTY_N2)}let n=0;for(let c of this.modules)n=c.reduce((g,u)=>g+(u?1:0),n);let o=this.size*this.size,a=Math.ceil(Math.abs(n*20-o*10)/o)-1;return l(a>=0&&a<=9),t+=a*r.PENALTY_N4,l(t>=0&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{let t=Math.floor(this.version/7)+2,n=Math.floor((this.version*8+t*3+5)/(t*4-4))*2,o=[6];for(let a=this.size-7;o.length<t;a-=n)o.splice(1,0,a);return o}}static getNumRawDataModules(t){if(t<r.MIN_VERSION||t>r.MAX_VERSION)throw new RangeError("Version number out of range");let n=(16*t+128)*t+64;if(t>=2){let o=Math.floor(t/7)+2;n-=(25*o-10)*o-55,t>=7&&(n-=36)}return l(n>=208&&n<=29648),n}static getNumDataCodewords(t,n){return Math.floor(r.getNumRawDataModules(t)/8)-r.ECC_CODEWORDS_PER_BLOCK[n.ordinal][t]*r.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let n=[];for(let a=0;a<t-1;a++)n.push(0);n.push(1);let o=1;for(let a=0;a<t;a++){for(let c=0;c<n.length;c++)n[c]=r.reedSolomonMultiply(n[c],o),c+1<n.length&&(n[c]^=n[c+1]);o=r.reedSolomonMultiply(o,2)}return n}static reedSolomonComputeRemainder(t,n){let o=n.map(a=>0);for(let a of t){let c=a^o.shift();o.push(0),n.forEach((g,u)=>o[u]^=r.reedSolomonMultiply(g,c))}return o}static reedSolomonMultiply(t,n){if(t>>>8||n>>>8)throw new RangeError("Byte out of range");let o=0;for(let a=7;a>=0;a--)o=o<<1^(o>>>7)*285,o^=(n>>>a&1)*t;return l(o>>>8==0),o}finderPenaltyCountPatterns(t){let n=t[1];l(n<=this.size*3);let o=n>0&&t[2]==n&&t[3]==n*3&&t[4]==n&&t[5]==n;return(o&&t[0]>=n*4&&t[6]>=n?1:0)+(o&&t[6]>=n*4&&t[0]>=n?1:0)}finderPenaltyTerminateAndCount(t,n,o){return t&&(this.finderPenaltyAddHistory(n,o),n=0),n+=this.size,this.finderPenaltyAddHistory(n,o),this.finderPenaltyCountPatterns(o)}finderPenaltyAddHistory(t,n){n[0]==0&&(t+=this.size),n.pop(),n.unshift(t)}static MIN_VERSION=1;static MAX_VERSION=40;static PENALTY_N1=3;static PENALTY_N2=3;static PENALTY_N3=40;static PENALTY_N4=10;static ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]];static NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]}return r})();s.QrCode=d;function e(r,p,t){if(p<0||p>31||r>>>p)throw new RangeError("Value out of range");for(let n=p-1;n>=0;n--)t.push(r>>>n&1)}function i(r,p){return(r>>>p&1)!=0}function l(r){if(!r)throw new Error("Assertion error")}let m=(()=>{class r{mode;numChars;bitData;static makeBytes(t){let n=[];for(let o of t)e(o,8,n);return new r(r.Mode.BYTE,t.length,n)}static makeNumeric(t){if(!r.isNumeric(t))throw new RangeError("String contains non-numeric characters");let n=[];for(let o=0;o<t.length;){let a=Math.min(t.length-o,3);e(parseInt(t.substring(o,o+a),10),a*3+1,n),o+=a}return new r(r.Mode.NUMERIC,t.length,n)}static makeAlphanumeric(t){if(!r.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let n=[],o;for(o=0;o+2<=t.length;o+=2){let a=r.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o))*45;a+=r.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o+1)),e(a,11,n)}return o<t.length&&e(r.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o)),6,n),new r(r.Mode.ALPHANUMERIC,t.length,n)}static makeSegments(t){return t==""?[]:r.isNumeric(t)?[r.makeNumeric(t)]:r.isAlphanumeric(t)?[r.makeAlphanumeric(t)]:[r.makeBytes(r.toUtf8ByteArray(t))]}static makeEci(t){let n=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)e(t,8,n);else if(t<16384)e(2,2,n),e(t,14,n);else if(t<1e6)e(6,3,n),e(t,21,n);else throw new RangeError("ECI assignment value out of range");return new r(r.Mode.ECI,0,n)}static isNumeric(t){return r.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return r.ALPHANUMERIC_REGEX.test(t)}constructor(t,n,o){if(this.mode=t,this.numChars=n,this.bitData=o,n<0)throw new RangeError("Invalid argument");this.bitData=o.slice()}getData(){return this.bitData.slice()}static getTotalBits(t,n){let o=0;for(let a of t){let c=a.mode.numCharCountBits(n);if(a.numChars>=1<<c)return 1/0;o+=4+c+a.bitData.length}return o}static toUtf8ByteArray(t){t=encodeURI(t);let n=[];for(let o=0;o<t.length;o++)t.charAt(o)!="%"?n.push(t.charCodeAt(o)):(n.push(parseInt(t.substring(o+1,o+3),16)),o+=2);return n}static NUMERIC_REGEX=/^[0-9]*$/;static ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+./:-]*$/;static ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"}return r})();s.QrSegment=m})(Q||(Q={}));(function(s){let d;(function(e){class i{ordinal;formatBits;static LOW=new i(0,1);static MEDIUM=new i(1,0);static QUARTILE=new i(2,3);static HIGH=new i(3,2);constructor(m,r){this.ordinal=m,this.formatBits=r}}e.Ecc=i})(d=s.QrCode||(s.QrCode={}))})(Q||(Q={}));(function(s){let d;(function(e){class i{modeBits;numBitsCharCount;static NUMERIC=new i(1,[10,12,14]);static ALPHANUMERIC=new i(2,[9,11,13]);static BYTE=new i(4,[8,16,16]);static KANJI=new i(8,[8,10,12]);static ECI=new i(7,[0,0,0]);constructor(m,r){this.modeBits=m,this.numBitsCharCount=r}numCharCountBits(m){return this.numBitsCharCount[Math.floor((m+7)/17)]}}e.Mode=i})(d=s.QrSegment||(s.QrSegment={}))})(Q||(Q={}));var se=Q,ee=se.QrCode.Ecc,Nt={L:ee.LOW,M:ee.MEDIUM,Q:ee.QUARTILE,H:ee.HIGH},Ue="M",ae="#FFFFFF",re="#000000",Mt=1,Dt=.1,He=(s,d=0)=>{let e=[];return s.forEach((i,l)=>{let m=null;i.forEach((r,p)=>{if(!r&&m!==null){e.push(`M${m+d} ${l+d}h${p-m}v1H${m+d}z`),m=null;return}if(p===i.length-1){if(!r)return;m===null?e.push(`M${p+d},${l+d} h1v1H${p+d}z`):e.push(`M${m+d},${l+d} h${p+1-m}v1H${m+d}z`);return}r&&m===null&&(m=p)})}),e.join("")},Ye=(s,d)=>s.slice().map((e,i)=>i<d.y||i>=d.y+d.h?e:e.map((l,m)=>m<d.x||m>=d.x+d.w?l:!1)),wt=(s,d,e,i)=>{if(i==null)return null;let l=s.length+e*2,m=Math.floor(d*Dt),r=l/d,p=(i.width||m)*r,t=(i.height||m)*r,n=i.x==null?s.length/2-p/2:i.x*r,o=i.y==null?s.length/2-t/2:i.y*r,a=i.opacity==null?1:i.opacity,c=null;if(i.excavate){let u=Math.floor(n),C=Math.floor(o),f=Math.ceil(p+n-u),L=Math.ceil(t+o-C);c={x:u,y:C,w:f,h:L}}let g=i.crossOrigin;return{x:n,y:o,h:t,w:p,excavation:c,opacity:a,crossOrigin:g}},Et=s=>Math.max(Math.floor(s),0),Rt=(()=>{try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),yt=(()=>{class s{canvas=ie.required("canvas");image=ie("image");icon=h("");margin=h(0);cells=h([]);numCells=h(0);calculatedImageSettings=h(null);size=h(160);color=h(re);bgColor=h(ae);constructor(){$(()=>{this.icon(),this.margin(),this.cells(),this.numCells(),this.calculatedImageSettings(),this.size(),this.color(),this.bgColor(),this.canvas()?.nativeElement&&this.render()})}ngAfterViewInit(){this.render()}render(){let e=this.canvas();if(!e)return;let i=e.nativeElement.getContext("2d");i&&(this.setupCanvas(i),this.drawQRCode(i),this.handleImageLoading(i))}setupCanvas(e){let i=this.canvas();if(!i)return;let l=window.devicePixelRatio||1;i.nativeElement.height=i.nativeElement.width=this.size()*l,i.nativeElement.style.width=i.nativeElement.style.height=`${this.size()}px`;let m=this.size()/this.numCells()*l;e.scale(m,m),e.fillStyle=this.bgColor(),e.fillRect(0,0,this.numCells(),this.numCells()),e.fillStyle=this.color()}drawQRCode(e){let i=this.getCellsToDraw();this.haveImageToRender()||this.renderQRCode(e,i)}getCellsToDraw(){let e=this.cells(),i=this.calculatedImageSettings();return this.haveImageToRender()&&i&&i.excavation&&(e=Ye(this.cells(),i.excavation)),e}haveImageToRender(){return this.calculatedImageSettings()!=null&&!!this.image()}renderQRCode(e,i){Rt?e.fill(new Path2D(He(i,this.margin()))):i.forEach((l,m)=>{l.forEach((r,p)=>{r&&e.fillRect(p+this.margin(),m+this.margin(),1,1)})})}handleImageLoading(e){if(!this.haveImageToRender())return;let i=this.image();if(!i)return;let l=()=>{this.cleanupImageListeners(l,m),this.onImageLoadSuccess(e)},m=()=>{this.cleanupImageListeners(l,m),this.onImageLoadError(e)};i.nativeElement.addEventListener("load",l),i.nativeElement.addEventListener("error",m)}onImageLoadSuccess(e){let i=this.getCellsToDraw();this.renderQRCode(e,i);let l=this.calculatedImageSettings(),m=this.image();l&&m&&(e.globalAlpha=l.opacity,e.drawImage(m.nativeElement,l.x+this.margin(),l.y+this.margin(),l.w,l.h))}onImageLoadError(e){let i=this.getCellsToDraw();this.renderQRCode(e,i)}cleanupImageListeners(e,i){let l=this.image();l?.nativeElement&&(l.nativeElement.removeEventListener("load",e),l.nativeElement.removeEventListener("error",i))}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=N({type:s,selectors:[["nz-qrcode-canvas"]],viewQuery:function(i,l){i&1&&(oe(l.canvas,at,5),oe(l.image,rt,5)),i&2&&Ne(2)},inputs:{icon:[1,"icon"],margin:[1,"margin"],cells:[1,"cells"],numCells:[1,"numCells"],calculatedImageSettings:[1,"calculatedImageSettings"],size:[1,"size"],color:[1,"color"],bgColor:[1,"bgColor"]},exportAs:["nzQRCodeCanvas"],decls:3,vars:1,consts:[["canvas",""],["image",""],["role","img"],["alt","QR-Code","crossorigin","anonymous",2,"display","none"]],template:function(i,l){i&1&&(V(0,"canvas",2,0),A(2,lt,2,1,"img",3)),i&2&&(w(2),B(l.icon()?2:-1))},styles:["[_nghost-%COMP%]{display:block;line-height:0}"],changeDetection:0})}return s})(),It=se.QrSegment,St=(s,d=Ue,e,i,l,m,r)=>{let p=bt(s,d,e,l),t=Et(m),n=p.getModules().length+t*2,o=wt(p.getModules(),i,t,r);return{cells:p.getModules(),margin:t,numCells:n,calculatedImageSettings:o,qrcode:p}},bt=(s,d=Ue,e,i)=>{let m=(Array.isArray(s)?s:[s]).reduce((r,p)=>(r.push(...It.makeSegments(p)),r),[]);return se.QrCode.encodeSegments(m,Nt[d],e,void 0,void 0,i)},_t=(()=>{class s{icon=h("");color=h(re);bgColor=h(ae);imageSettings=h();size=h(160);margin=h(0);calculatedImageSettings=h(null);cells=h([]);numCells=h(0);viewBox="";backgroundPath="";foregroundPath="";constructor(){$(()=>{this.initializeViewBox(),this.generatePaths()})}initializeViewBox(){this.viewBox=`0 0 ${this.numCells()} ${this.numCells()}`,this.backgroundPath=`M0,0 h${this.numCells()}v${this.numCells()}H0z`}generatePaths(){let e=this.getCellsToDraw();this.foregroundPath=He(e,this.margin())}getCellsToDraw(){return this.shouldExcavateCells()?Ye(this.cells(),this.calculatedImageSettings().excavation):this.cells()}shouldExcavateCells(){let e=this.calculatedImageSettings();return e!==null&&!!this.icon()&&e.excavation!==null}shouldShowIcon(){return!!this.icon()&&this.calculatedImageSettings()!=null}getImageX(){return(this.calculatedImageSettings()?.x||0)+this.margin()}getImageY(){return(this.calculatedImageSettings()?.y||0)+this.margin()}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=N({type:s,selectors:[["nz-qrcode-svg"]],inputs:{icon:[1,"icon"],color:[1,"color"],bgColor:[1,"bgColor"],imageSettings:[1,"imageSettings"],size:[1,"size"],margin:[1,"margin"],calculatedImageSettings:[1,"calculatedImageSettings"],cells:[1,"cells"],numCells:[1,"numCells"]},exportAs:["nzQRCodeSVG"],decls:4,vars:8,consts:[["role","img"],["shapeRendering","crispEdges"],["preserveAspectRatio","none"]],template:function(i,l){i&1&&(ne(),ge(0,"svg",0),V(1,"path",1)(2,"path",1),A(3,ct,1,7,":svg:image",2),pe()),i&2&&(F("height",l.size())("width",l.size())("viewBox",l.viewBox),w(),F("fill",l.bgColor())("d",l.backgroundPath),w(),F("fill",l.color())("d",l.foregroundPath),w(),B(l.shouldShowIcon()?3:-1))},styles:["[_nghost-%COMP%]{display:block;line-height:0}"],changeDetection:0})}return s})(),M=(()=>{class s{i18n=te(Ae);locale=Te(this.i18n.localeChange.pipe(le(()=>this.i18n.getLocaleData("QRCode"))),{requireSync:!0});isBrowser=Pe(te(de));nzValue=h("");nzType=h("canvas");nzColor=h(re);nzBgColor=h(ae);nzSize=h(160);nzIcon=h("");nzIconSize=h(40);nzBordered=h(!0);nzStatus=h("active");nzLevel=h("M");nzStatusRender=h(null);nzBoostLevel=h(!0);nzPadding=h(0);nzRefresh=_e();margin=k(0);cells=k([]);numCells=k(0);calculatedImageSettings=k(null);imageSettings=be(()=>({src:this.nzIcon(),x:void 0,y:void 0,height:this.nzIconSize()??40,width:this.nzIconSize()??40,excavate:!0,crossOrigin:"anonymous"}));constructor(){$(()=>{this.updateQRCodeData()})}reloadQRCode(){this.updateQRCodeData(),this.nzRefresh.emit("refresh")}updateQRCodeData(){let{margin:e,cells:i,numCells:l,calculatedImageSettings:m}=St(this.nzValue(),this.nzLevel(),Mt,this.nzSize(),this.nzBoostLevel(),this.nzPadding(),this.imageSettings());this.margin.set(e),this.cells.set(i),this.numCells.set(l),this.calculatedImageSettings.set(m)}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=N({type:s,selectors:[["nz-qrcode"]],hostAttrs:[1,"ant-qrcode"],hostVars:4,hostBindings:function(i,l){i&2&&(De("background-color",l.nzBgColor()),we("ant-qrcode-border",l.nzBordered()))},inputs:{nzValue:[1,"nzValue"],nzType:[1,"nzType"],nzColor:[1,"nzColor"],nzBgColor:[1,"nzBgColor"],nzSize:[1,"nzSize"],nzIcon:[1,"nzIcon"],nzIconSize:[1,"nzIconSize"],nzBordered:[1,"nzBordered"],nzStatus:[1,"nzStatus"],nzLevel:[1,"nzLevel"],nzStatusRender:[1,"nzStatusRender"],nzBoostLevel:[1,"nzBoostLevel"],nzPadding:[1,"nzPadding"]},outputs:{nzRefresh:"nzRefresh"},exportAs:["nzQRCode"],decls:3,vars:2,consts:[[1,"ant-qrcode-mask"],[4,"nzStringTemplateOutlet"],[1,"ant-qrcode-expired"],["nz-button","","nzType","link",3,"click"],["nzType","reload","nzTheme","outline"],[3,"icon","margin","cells","numCells","calculatedImageSettings","size","color","bgColor"],[3,"color","bgColor","icon","margin","cells","numCells","imageSettings","calculatedImageSettings","size"]],template:function(i,l){i&1&&(A(0,ut,2,1,"div",0)(1,ht,4,1,"div",0),A(2,vt,2,1)),i&2&&(B(l.nzStatusRender()?0:l.nzStatus()!=="active"?1:-1),w(2),B(l.isBrowser?2:-1))},dependencies:[Ve,ke,J,Z,j,K,W,xe,_t,yt],encapsulation:2,changeDetection:0})}return s})(),D=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275mod=ue({type:s});static \u0275inj=ce({imports:[M]})}return s})();var $e=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-background"]],decls:2,vars:0,consts:[["nzBgColor","#f6f6f6","nzColor","#ff6600","nzValue","https://ng.ant.design/"],["nzBgColor","#f6f6f6","nzColor","#1677ff","nzValue","https://ng.ant.design/"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)(1,"nz-qrcode",1)},dependencies:[D,M],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px}"]})};var Ge=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-basic"]],decls:1,vars:0,consts:[["nzValue","https://ng.ant.design/"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)},dependencies:[D,M],encapsulation:2})};var Xe=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-color"]],decls:2,vars:0,consts:[["nzValue","https://ng.ant.design/","nzColor","#ff6600"],["nzValue","https://ng.ant.design/","nzColor","#1677ff"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)(1,"nz-qrcode",1)},dependencies:[D,M],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px}"]})};function Pt(s,d){s&1&&(E(0,"div"),z(1,"nz-icon",3),P(2," success "),R())}var We=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-custom-status"]],decls:4,vars:1,consts:[["customTemplate",""],["nzValue","https://ng.ant.design/","nzStatusRender","NgZorro"],["nzValue","https://ng.ant.design/",3,"nzStatusRender"],["nzType","check-circle","nzTheme","outline",2,"color","red"]],template:function(e,i){if(e&1&&(z(0,"nz-qrcode",1)(1,"nz-qrcode",2),G(2,Pt,3,0,"ng-template",null,0,Se)),e&2){let l=Me(3);w(),I("nzStatusRender",l)}},dependencies:[D,M,K,W],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px}"]})};var Tt=["download"],Ke=class s{download;downloadImg(){let d=document.getElementById("download")?.querySelector("canvas");if(d){this.download.nativeElement.href=d.toDataURL("image/png"),this.download.nativeElement.download="ng-zorro-antd";let e=new MouseEvent("click");this.download.nativeElement.dispatchEvent(e)}}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-download"]],viewQuery:function(e,i){if(e&1&&Ce(Tt,5),e&2){let l;ze(l=ve())&&(i.download=l.first)}},decls:6,vars:0,consts:[["download",""],["id","download"],["nzValue","https://ng.ant.design/"],["nz-button","","nzType","primary",3,"click"]],template:function(e,i){if(e&1){let l=X();E(0,"div",1),z(1,"nz-qrcode",2)(2,"a",null,0),E(4,"button",3),q("click",function(){return H(l),Y(i.downloadImg())}),P(5,"Download"),R()()}},dependencies:[J,Z,j,Le,D,M],styles:["div[_ngcontent-%COMP%]{display:flex;align-items:flex-start;flex-direction:column}nz-qrcode[_ngcontent-%COMP%]{margin-bottom:12px}"]})};var je=class s{options=["L","M","Q","H"];errorLevel="L";static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-error-level"]],decls:2,vars:3,consts:[["nzValue","https://github.com/NG-ZORRO/ng-zorro-antd/issues",3,"nzLevel"],[3,"ngModelChange","nzOptions","ngModel"]],template:function(e,i){e&1&&(z(0,"nz-qrcode",0),E(1,"nz-segmented",1),ye("ngModelChange",function(m){return Re(i.errorLevel,m)||(i.errorLevel=m),m}),R()),e&2&&(I("nzLevel",i.errorLevel),w(),I("nzOptions",i.options),Ee("ngModel",i.errorLevel))},dependencies:[D,M,qe,Fe,Oe,Be,Qe],styles:["[_nghost-%COMP%]{display:flex;align-items:flex-start;flex-direction:column}nz-qrcode[_ngcontent-%COMP%]{margin-bottom:12px}"]})};var Ze=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-icon"]],decls:1,vars:0,consts:[["nzValue","https://ng.ant.design/","nzIcon","https://img.alicdn.com/imgextra/i2/O1CN01TBIkzL1Nk3IBB0DLA_!!6000000001607-2-tps-106-120.png","nzLevel","H"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)},dependencies:[D,M],encapsulation:2})};var Je=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-padding"]],decls:2,vars:2,consts:[["nzValue","https://ng.ant.design/",3,"nzPadding"],["nzType","svg","nzValue","https://ng.ant.design/",3,"nzPadding"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)(1,"nz-qrcode",1),e&2&&(I("nzPadding",2),w(),I("nzPadding",2))},dependencies:[D,M],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px;padding:0}"]})};var et=class s{refresh(d){console.log(d)}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-status"]],decls:3,vars:0,consts:[["nzValue","https://ng.ant.design/","nzStatus","loading"],["nzValue","https://ng.ant.design/","nzStatus","expired",3,"nzRefresh"],["nzValue","https://ng.ant.design/","nzStatus","scanned"]],template:function(e,i){e&1&&(z(0,"nz-qrcode",0),E(1,"nz-qrcode",1),q("nzRefresh",function(m){return i.refresh(m)}),R(),z(2,"nz-qrcode",2))},dependencies:[D,M],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px}"]})};var tt=class s{static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["nz-demo-qr-code-type"]],decls:2,vars:0,consts:[["nzValue","https://ng.ant.design/"],["nzValue","https://ng.ant.design/","nzType","svg"]],template:function(e,i){e&1&&z(0,"nz-qrcode",0)(1,"nz-qrcode",1)},dependencies:[D,M],styles:["nz-qrcode[_ngcontent-%COMP%]{margin-right:12px}"]})};export{$e as a,Ge as b,Xe as c,We as d,Ke as e,je as f,Ze as g,Je as h,et as i,tt as j};
