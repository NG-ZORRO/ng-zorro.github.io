(self.webpackChunkng_zorro_antd=self.webpackChunkng_zorro_antd||[]).push([[8360],{48360:function(t,e,n){"use strict";n.d(e,{FY:function(){return $t},cS:function(){return Pt}});var i=n(36461),o=n(91841),s=n(37716),l=n(25917),a=n(67574),r=n(75319),c=n(79765),p=n(43190),d=n(88002),u=n(45435),h=n(46782),f=n(61055),g=n(17238),m=n(80521),z=n(38583),w=n(64762),y=n(70946),x=n(14176),v=n(27266),T=n(3679),C=n(11959),b=n(48095),F=n(49774),I=n(82949),O=n(16905);const L=["file"],k=["nz-upload-btn",""],N=["*"];function D(t,e){}const S=function(t){return{$implicit:t}};function U(t,e){if(1&t&&(s.TgZ(0,"div",18),s.YNc(1,D,0,0,"ng-template",19),s.qZA()),2&t){const t=s.oxw(2).$implicit,e=s.MAs(5);s.ekj("ant-upload-list-item-file",!t.isUploading),s.xp6(1),s.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",s.VKq(4,S,t))}}function Q(t,e){if(1&t&&s._UZ(0,"img",22),2&t){const t=s.oxw(3).$implicit;s.Q6J("src",t.thumbUrl||t.url,s.LSH),s.uIk("alt",t.name)}}function Y(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"a",20),s.NdJ("click",function(e){s.CHM(t);const n=s.oxw(2).$implicit;return s.oxw().handlePreview(n,e)}),s.YNc(1,Q,1,2,"img",21),s.qZA()}if(2&t){s.oxw();const t=s.MAs(5),e=s.oxw().$implicit;s.ekj("ant-upload-list-item-file",!e.isImageUrl),s.Q6J("href",e.url||e.thumbUrl,s.LSH),s.xp6(1),s.Q6J("ngIf",e.isImageUrl)("ngIfElse",t)}}function J(t,e){}function R(t,e){if(1&t&&(s.TgZ(0,"div",23),s.YNc(1,J,0,0,"ng-template",19),s.qZA()),2&t){const t=s.oxw(2).$implicit,e=s.MAs(5);s.xp6(1),s.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",s.VKq(2,S,t))}}function A(t,e){}function M(t,e){if(1&t&&s.YNc(0,A,0,0,"ng-template",19),2&t){const t=s.oxw(2).$implicit,e=s.MAs(5);s.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",s.VKq(2,S,t))}}function Z(t,e){if(1&t&&(s.ynx(0,13),s.YNc(1,U,2,6,"div",14),s.YNc(2,Y,2,5,"a",15),s.YNc(3,R,2,4,"div",16),s.BQk(),s.YNc(4,M,1,4,"ng-template",null,17,s.W1O)),2&t){const t=s.oxw().$implicit;s.Q6J("ngSwitch",t.iconType),s.xp6(1),s.Q6J("ngSwitchCase","uploading"),s.xp6(1),s.Q6J("ngSwitchCase","thumbnail")}}function $(t,e){1&t&&(s.ynx(0),s._UZ(1,"i",29),s.BQk())}function P(t,e){if(1&t&&(s.ynx(0),s.YNc(1,$,2,0,"ng-container",24),s.BQk()),2&t){const t=s.oxw(2).$implicit,e=s.MAs(4);s.xp6(1),s.Q6J("ngIf",t.isUploading)("ngIfElse",e)}}function q(t,e){if(1&t&&(s.ynx(0),s._uU(1),s.BQk()),2&t){const t=s.oxw(5);s.xp6(1),s.hij(" ",t.locale.uploading," ")}}function E(t,e){if(1&t&&(s.ynx(0),s.YNc(1,q,2,1,"ng-container",24),s.BQk()),2&t){const t=s.oxw(2).$implicit,e=s.MAs(4);s.xp6(1),s.Q6J("ngIf",t.isUploading)("ngIfElse",e)}}function B(t,e){if(1&t&&s._UZ(0,"i",30),2&t){const t=s.oxw(2).$implicit;s.Q6J("nzType",t.isUploading?"loading":"paper-clip")}}function j(t,e){if(1&t&&(s.ynx(0),s.ynx(1,13),s.YNc(2,P,2,2,"ng-container",27),s.YNc(3,E,2,2,"ng-container",27),s.YNc(4,B,1,1,"i",28),s.BQk(),s.BQk()),2&t){const t=s.oxw(3);s.xp6(1),s.Q6J("ngSwitch",t.listType),s.xp6(1),s.Q6J("ngSwitchCase","picture"),s.xp6(1),s.Q6J("ngSwitchCase","picture-card")}}function _(t,e){}function W(t,e){if(1&t&&s._UZ(0,"i",31),2&t){const t=s.oxw().$implicit;s.Q6J("nzType",t.isImageUrl?"picture":"file")}}function H(t,e){if(1&t&&(s.YNc(0,j,5,3,"ng-container",24),s.YNc(1,_,0,0,"ng-template",19,25,s.W1O),s.YNc(3,W,1,1,"ng-template",null,26,s.W1O)),2&t){const t=e.$implicit,n=s.MAs(2),i=s.oxw(2);s.Q6J("ngIf",!i.iconRender)("ngIfElse",n),s.xp6(1),s.Q6J("ngTemplateOutlet",i.iconRender)("ngTemplateOutletContext",s.VKq(4,S,t))}}function K(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",33),s.NdJ("click",function(e){s.CHM(t);const n=s.oxw(2).$implicit;return s.oxw().handleRemove(n,e)}),s._UZ(1,"i",34),s.qZA()}if(2&t){const t=s.oxw(3);s.uIk("title",t.locale.removeFile)}}function G(t,e){if(1&t&&s.YNc(0,K,2,1,"button",32),2&t){const t=s.oxw(2);s.Q6J("ngIf",t.icons.showRemoveIcon)}}function V(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",33),s.NdJ("click",function(){s.CHM(t);const e=s.oxw(2).$implicit;return s.oxw().handleDownload(e)}),s._UZ(1,"i",35),s.qZA()}if(2&t){const t=s.oxw(3);s.uIk("title",t.locale.downloadFile)}}function X(t,e){if(1&t&&s.YNc(0,V,2,1,"button",32),2&t){const t=s.oxw().$implicit;s.Q6J("ngIf",t.showDownload)}}function tt(t,e){}function et(t,e){}function nt(t,e){if(1&t&&(s.TgZ(0,"span"),s.YNc(1,tt,0,0,"ng-template",10),s.YNc(2,et,0,0,"ng-template",10),s.qZA()),2&t){s.oxw(2);const t=s.MAs(9),e=s.MAs(7),n=s.oxw();s.Gre("ant-upload-list-item-card-actions ","picture"===n.listType?"picture":"",""),s.xp6(1),s.Q6J("ngTemplateOutlet",t),s.xp6(1),s.Q6J("ngTemplateOutlet",e)}}function it(t,e){if(1&t&&s.YNc(0,nt,3,5,"span",36),2&t){const t=s.oxw(2);s.Q6J("ngIf","picture-card"!==t.listType)}}function ot(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"a",39),s.NdJ("click",function(e){s.CHM(t);const n=s.oxw(2).$implicit;return s.oxw().handlePreview(n,e)}),s._uU(1),s.qZA()}if(2&t){const t=s.oxw(2).$implicit;s.Q6J("href",t.url,s.LSH),s.uIk("title",t.name)("download",t.linkProps&&t.linkProps.download),s.xp6(1),s.hij(" ",t.name," ")}}function st(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"span",40),s.NdJ("click",function(e){s.CHM(t);const n=s.oxw(2).$implicit;return s.oxw().handlePreview(n,e)}),s._uU(1),s.qZA()}if(2&t){const t=s.oxw(2).$implicit;s.uIk("title",t.name),s.xp6(1),s.hij(" ",t.name," ")}}function lt(t,e){}function at(t,e){if(1&t&&(s.YNc(0,ot,2,4,"a",37),s.YNc(1,st,2,2,"span",38),s.YNc(2,lt,0,0,"ng-template",10)),2&t){const t=s.oxw().$implicit,e=s.MAs(11);s.Q6J("ngIf",t.url),s.xp6(1),s.Q6J("ngIf",!t.url),s.xp6(1),s.Q6J("ngTemplateOutlet",e)}}function rt(t,e){}function ct(t,e){}const pt=function(){return{opacity:.5,"pointer-events":"none"}};function dt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"a",44),s.NdJ("click",function(e){s.CHM(t);const n=s.oxw(2).$implicit;return s.oxw().handlePreview(n,e)}),s._UZ(1,"i",45),s.qZA()}if(2&t){const t=s.oxw(2).$implicit,e=s.oxw();s.Q6J("href",t.url||t.thumbUrl,s.LSH)("ngStyle",t.url||t.thumbUrl?null:s.DdM(3,pt)),s.uIk("title",e.locale.previewFile)}}function ut(t,e){}function ht(t,e){if(1&t&&(s.ynx(0),s.YNc(1,ut,0,0,"ng-template",10),s.BQk()),2&t){s.oxw(2);const t=s.MAs(9);s.xp6(1),s.Q6J("ngTemplateOutlet",t)}}function ft(t,e){}function gt(t,e){if(1&t&&(s.TgZ(0,"span",41),s.YNc(1,dt,2,4,"a",42),s.YNc(2,ht,2,1,"ng-container",43),s.YNc(3,ft,0,0,"ng-template",10),s.qZA()),2&t){const t=s.oxw().$implicit,e=s.MAs(7),n=s.oxw();s.xp6(1),s.Q6J("ngIf",n.icons.showPreviewIcon),s.xp6(1),s.Q6J("ngIf","done"===t.status),s.xp6(1),s.Q6J("ngTemplateOutlet",e)}}function mt(t,e){if(1&t&&(s.TgZ(0,"div",46),s._UZ(1,"nz-progress",47),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("nzPercent",t.percent)("nzShowInfo",!1)("nzStrokeWidth",2)}}function zt(t,e){if(1&t&&(s.TgZ(0,"div"),s.TgZ(1,"div",1),s.YNc(2,Z,6,3,"ng-template",null,2,s.W1O),s.YNc(4,H,5,6,"ng-template",null,3,s.W1O),s.YNc(6,G,1,1,"ng-template",null,4,s.W1O),s.YNc(8,X,1,1,"ng-template",null,5,s.W1O),s.YNc(10,it,1,1,"ng-template",null,6,s.W1O),s.YNc(12,at,3,3,"ng-template",null,7,s.W1O),s.TgZ(14,"div",8),s.TgZ(15,"span",9),s.YNc(16,rt,0,0,"ng-template",10),s.YNc(17,ct,0,0,"ng-template",10),s.qZA(),s.qZA(),s.YNc(18,gt,4,3,"span",11),s.YNc(19,mt,2,3,"div",12),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.MAs(3),i=s.MAs(13),o=s.oxw();s.Gre("ant-upload-list-",o.listType,"-container"),s.xp6(1),s.MT6("ant-upload-list-item ant-upload-list-item-",t.status," ant-upload-list-item-list-type-",o.listType,""),s.Q6J("@itemState",void 0)("nzTooltipTitle","error"===t.status?t.message:null),s.uIk("data-key",t.key),s.xp6(15),s.Q6J("ngTemplateOutlet",n),s.xp6(1),s.Q6J("ngTemplateOutlet",i),s.xp6(1),s.Q6J("ngIf","picture-card"===o.listType&&!t.isUploading),s.xp6(1),s.Q6J("ngIf",t.isUploading)}}const wt=["uploadComp"],yt=["listComp"],xt=function(){return[]};function vt(t,e){if(1&t&&s._UZ(0,"nz-upload-list",8,9),2&t){const t=s.oxw(2);s.Udp("display",t.nzShowUploadList?"":"none"),s.Q6J("locale",t.locale)("listType",t.nzListType)("items",t.nzFileList||s.DdM(13,xt))("icons",t.nzShowUploadList)("iconRender",t.nzIconRender)("previewFile",t.nzPreviewFile)("previewIsImage",t.nzPreviewIsImage)("onPreview",t.nzPreview)("onRemove",t.onRemove)("onDownload",t.nzDownload)("dir",t.dir)}}function Tt(t,e){1&t&&s.GkF(0)}function Ct(t,e){if(1&t&&(s.ynx(0),s.YNc(1,Tt,1,0,"ng-container",10),s.BQk()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngTemplateOutlet",t.nzFileListRender)("ngTemplateOutletContext",s.VKq(2,S,t.nzFileList))}}function bt(t,e){if(1&t&&(s.YNc(0,vt,2,14,"nz-upload-list",6),s.YNc(1,Ct,2,4,"ng-container",7)),2&t){const t=s.oxw();s.Q6J("ngIf",t.locale&&!t.nzFileListRender),s.xp6(1),s.Q6J("ngIf",t.nzFileListRender)}}function Ft(t,e){1&t&&s.Hsn(0)}function It(t,e){}function Ot(t,e){if(1&t&&(s.TgZ(0,"div",11),s.TgZ(1,"div",12,13),s.YNc(3,It,0,0,"ng-template",14),s.qZA(),s.qZA()),2&t){const t=s.oxw(),e=s.MAs(3);s.Udp("display",t.nzShowButton?"":"none"),s.Q6J("ngClass",t.classList),s.xp6(1),s.Q6J("options",t._btnOptions),s.xp6(2),s.Q6J("ngTemplateOutlet",e)}}function Lt(t,e){}function kt(t,e){}function Nt(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"div",15),s.NdJ("drop",function(e){return s.CHM(t),s.oxw().fileDrop(e)})("dragover",function(e){return s.CHM(t),s.oxw().fileDrop(e)})("dragleave",function(e){return s.CHM(t),s.oxw().fileDrop(e)}),s.TgZ(2,"div",16,13),s.TgZ(4,"div",17),s.YNc(5,Lt,0,0,"ng-template",14),s.qZA(),s.qZA(),s.qZA(),s.YNc(6,kt,0,0,"ng-template",14),s.BQk()}if(2&t){const t=s.oxw(),e=s.MAs(3),n=s.MAs(1);s.xp6(1),s.Q6J("ngClass",t.classList),s.xp6(1),s.Q6J("options",t._btnOptions),s.xp6(3),s.Q6J("ngTemplateOutlet",e),s.xp6(1),s.Q6J("ngTemplateOutlet",n)}}function Dt(t,e){}function St(t,e){}function Ut(t,e){if(1&t&&(s.ynx(0),s.YNc(1,Dt,0,0,"ng-template",14),s.YNc(2,St,0,0,"ng-template",14),s.BQk()),2&t){s.oxw(2);const t=s.MAs(1),e=s.MAs(5);s.xp6(1),s.Q6J("ngTemplateOutlet",t),s.xp6(1),s.Q6J("ngTemplateOutlet",e)}}function Qt(t,e){if(1&t&&s.YNc(0,Ut,3,2,"ng-container",3),2&t){const t=s.oxw(),e=s.MAs(10);s.Q6J("ngIf","picture-card"===t.nzListType)("ngIfElse",e)}}function Yt(t,e){}function Jt(t,e){}function Rt(t,e){if(1&t&&(s.YNc(0,Yt,0,0,"ng-template",14),s.YNc(1,Jt,0,0,"ng-template",14)),2&t){s.oxw();const t=s.MAs(5),e=s.MAs(1);s.Q6J("ngTemplateOutlet",t),s.xp6(1),s.Q6J("ngTemplateOutlet",e)}}let At=(()=>{class t{constructor(t,e){if(this.http=t,this.elementRef=e,this.reqs={},this.destroy=!1,this.elementRef.nativeElement.classList.add("ant-upload"),!t)throw new Error("Not found 'HttpClient', You can import 'HttpClientModule' in your root module.")}onClick(){!this.options.disabled&&this.options.openFileDialogOnClick&&this.file.nativeElement.click()}onKeyDown(t){this.options.disabled||"Enter"!==t.key&&t.keyCode!==i.K5||this.onClick()}onFileDrop(t){if(this.options.disabled||"dragover"===t.type)t.preventDefault();else{if(this.options.directory)this.traverseFileTree(t.dataTransfer.items);else{const e=Array.prototype.slice.call(t.dataTransfer.files).filter(t=>this.attrAccept(t,this.options.accept));e.length&&this.uploadFiles(e)}t.preventDefault()}}onChange(t){if(this.options.disabled)return;const e=t.target;this.uploadFiles(e.files),e.value=""}traverseFileTree(t){const e=(t,n)=>{t.isFile?t.file(t=>{this.attrAccept(t,this.options.accept)&&this.uploadFiles([t])}):t.isDirectory&&t.createReader().readEntries(i=>{for(const o of i)e(o,`${n}${t.name}/`)})};for(const n of t)e(n.webkitGetAsEntry(),"")}attrAccept(t,e){if(t&&e){const n=Array.isArray(e)?e:e.split(","),i=`${t.name}`,o=`${t.type}`,s=o.replace(/\/.*$/,"");return n.some(t=>{const e=t.trim();return"."===e.charAt(0)?-1!==i.toLowerCase().indexOf(e.toLowerCase(),i.toLowerCase().length-e.toLowerCase().length):/\/\*$/.test(e)?s===e.replace(/\/.*$/,""):o===e})}return!0}attachUid(t){return t.uid||(t.uid=Math.random().toString(36).substring(2)),t}uploadFiles(t){let e=(0,l.of)(Array.prototype.slice.call(t));this.options.filters&&this.options.filters.forEach(t=>{e=e.pipe((0,p.w)(e=>{const n=t.fn(e);return n instanceof a.y?n:(0,l.of)(n)}))}),e.subscribe(t=>{t.forEach(e=>{this.attachUid(e),this.upload(e,t)})},t=>{(0,f.ZK)("Unhandled upload filter error",t)})}upload(t,e){if(!this.options.beforeUpload)return this.post(t);const n=this.options.beforeUpload(t,e);if(n instanceof a.y)n.subscribe(e=>{const n=Object.prototype.toString.call(e);"[object File]"===n||"[object Blob]"===n?(this.attachUid(e),this.post(e)):"boolean"==typeof e&&!1!==e&&this.post(t)},t=>{(0,f.ZK)("Unhandled upload beforeUpload error",t)});else if(!1!==n)return this.post(t)}post(t){if(this.destroy)return;let e=(0,l.of)(t);const n=this.options,{uid:i}=t,{action:o,data:s,headers:c,transformFile:u}=n,h={action:"string"==typeof o?o:"",name:n.name,headers:c,file:t,postFile:t,data:s,withCredentials:n.withCredentials,onProgress:n.onProgress?e=>{n.onProgress(e,t)}:void 0,onSuccess:(e,o)=>{this.clean(i),n.onSuccess(e,t,o)},onError:e=>{this.clean(i),n.onError(e,t)}};if("function"==typeof o){const n=o(t);n instanceof a.y?e=e.pipe((0,p.w)(()=>n),(0,d.U)(e=>(h.action=e,t))):h.action=n}if("function"==typeof u){const n=u(t);e=e.pipe((0,p.w)(()=>n instanceof a.y?n:(0,l.of)(n)))}if("function"==typeof s){const n=s(t);n instanceof a.y?e=e.pipe((0,p.w)(()=>n),(0,d.U)(e=>(h.data=e,t))):h.data=n}if("function"==typeof c){const n=c(t);n instanceof a.y?e=e.pipe((0,p.w)(()=>n),(0,d.U)(e=>(h.headers=e,t))):h.headers=n}e.subscribe(e=>{h.postFile=e;const o=(n.customRequest||this.xhr).call(this,h);o instanceof r.w||(0,f.ZK)("Must return Subscription type in '[nzCustomRequest]' property"),this.reqs[i]=o,n.onStart(t)})}xhr(t){const e=new FormData;t.data&&Object.keys(t.data).map(n=>{e.append(n,t.data[n])}),e.append(t.name,t.postFile),t.headers||(t.headers={}),null!==t.headers["X-Requested-With"]?t.headers["X-Requested-With"]="XMLHttpRequest":delete t.headers["X-Requested-With"];const n=new o.aW("POST",t.action,e,{reportProgress:!0,withCredentials:t.withCredentials,headers:new o.WM(t.headers)});return this.http.request(n).subscribe(e=>{e.type===o.dt.UploadProgress?(e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e,t.file)):e instanceof o.Zn&&t.onSuccess(e.body,t.file,e)},e=>{this.abort(t.file),t.onError(e,t.file)})}clean(t){const e=this.reqs[t];e instanceof r.w&&e.unsubscribe(),delete this.reqs[t]}abort(t){t?this.clean(t&&t.uid):Object.keys(this.reqs).forEach(t=>this.clean(t))}ngOnDestroy(){this.destroy=!0,this.abort()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(o.eN,8),s.Y36(s.SBq))},t.\u0275cmp=s.Xpm({type:t,selectors:[["","nz-upload-btn",""]],viewQuery:function(t,e){if(1&t&&s.Gf(L,5),2&t){let t;s.iGM(t=s.CRH())&&(e.file=t.first)}},hostVars:4,hostBindings:function(t,e){1&t&&s.NdJ("click",function(){return e.onClick()})("keydown",function(t){return e.onKeyDown(t)})("drop",function(t){return e.onFileDrop(t)})("dragover",function(t){return e.onFileDrop(t)}),2&t&&(s.uIk("tabindex","0")("role","button"),s.ekj("ant-upload-disabled",e.options.disabled))},inputs:{options:"options"},exportAs:["nzUploadBtn"],attrs:k,ngContentSelectors:N,decls:3,vars:4,consts:[["type","file",2,"display","none",3,"multiple","change"],["file",""]],template:function(t,e){1&t&&(s.F$t(),s.TgZ(0,"input",0,1),s.NdJ("change",function(t){return e.onChange(t)}),s.qZA(),s.Hsn(2)),2&t&&(s.Q6J("multiple",e.options.multiple),s.uIk("accept",e.options.accept)("directory",e.options.directory?"directory":null)("webkitdirectory",e.options.directory?"webkitdirectory":null))},encapsulation:2}),t})();const Mt=t=>!!t&&0===t.indexOf("image/");let Zt=(()=>{class t{constructor(t,e,n,i,o){this.cdr=t,this.doc=e,this.ngZone=n,this.platform=i,this.elementRef=o,this.list=[],this.locale={},this.iconRender=null,this.dir="ltr",this.elementRef.nativeElement.classList.add("ant-upload-list")}get showPic(){return"picture"===this.listType||"picture-card"===this.listType}set items(t){this.list=t}genErr(t){return t.response&&"string"==typeof t.response?t.response:t.error&&t.error.statusText||this.locale.uploadError}extname(t){const e=t.split("/"),n=e[e.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(n)||[""])[0]}isImageUrl(t){if(Mt(t.type))return!0;const e=t.thumbUrl||t.url||"";if(!e)return!1;const n=this.extname(e);return!(!/^data:image\//.test(e)&&!/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg)$/i.test(n))||!/^data:/.test(e)&&!n}getIconType(t){return this.showPic?t.isUploading||!t.thumbUrl&&!t.url?"uploading":"thumbnail":""}previewImage(t){return new Promise(e=>{Mt(t.type)&&this.platform.isBrowser?this.ngZone.runOutsideAngular(()=>{const n=this.doc.createElement("canvas");n.width=200,n.height=200,n.style.cssText="position: fixed; left: 0; top: 0; width: 200px; height: 200px; z-index: 9999; display: none;",this.doc.body.appendChild(n);const i=n.getContext("2d"),o=new Image;o.onload=()=>{const{width:t,height:s}=o;let l=200,a=200,r=0,c=0;t<s?(a=s*(200/t),c=-(a-l)/2):(l=t*(200/s),r=-(l-a)/2);try{i.drawImage(o,r,c,l,a)}catch(d){}const p=n.toDataURL();this.doc.body.removeChild(n),e(p)},o.src=window.URL.createObjectURL(t)}):e("")})}genThumb(){if(!this.platform.isBrowser)return;const t=window;this.showPic&&"undefined"!=typeof document&&void 0!==t&&t.FileReader&&t.File&&this.list.filter(t=>t.originFileObj instanceof File&&void 0===t.thumbUrl).forEach(t=>{t.thumbUrl="",(this.previewFile?this.previewFile(t).toPromise():this.previewImage(t.originFileObj)).then(e=>{t.thumbUrl=e,this.detectChanges()})})}showDownload(t){return!(!this.icons.showDownloadIcon||"done"!==t.status)}fixData(){this.list.forEach(t=>{t.isUploading="uploading"===t.status,t.message=this.genErr(t),t.linkProps="string"==typeof t.linkProps?JSON.parse(t.linkProps):t.linkProps,t.isImageUrl=this.previewIsImage?this.previewIsImage(t):this.isImageUrl(t),t.iconType=this.getIconType(t),t.showDownload=this.showDownload(t)})}handlePreview(t,e){if(this.onPreview)return e.preventDefault(),this.onPreview(t)}handleRemove(t,e){e.preventDefault(),this.onRemove&&this.onRemove(t)}handleDownload(t){"function"==typeof this.onDownload?this.onDownload(t):t.url&&window.open(t.url)}detectChanges(){this.fixData(),this.cdr.detectChanges()}ngOnChanges(){this.fixData(),this.genThumb()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.sBO),s.Y36(z.K0),s.Y36(s.R0b),s.Y36(m.t4),s.Y36(s.SBq))},t.\u0275cmp=s.Xpm({type:t,selectors:[["nz-upload-list"]],hostVars:8,hostBindings:function(t,e){2&t&&s.ekj("ant-upload-list-rtl","rtl"===e.dir)("ant-upload-list-text","text"===e.listType)("ant-upload-list-picture","picture"===e.listType)("ant-upload-list-picture-card","picture-card"===e.listType)},inputs:{locale:"locale",iconRender:"iconRender",dir:"dir",items:"items",listType:"listType",icons:"icons",onPreview:"onPreview",onRemove:"onRemove",onDownload:"onDownload",previewFile:"previewFile",previewIsImage:"previewIsImage"},exportAs:["nzUploadList"],features:[s.TTD],decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],["nz-tooltip","",3,"nzTooltipTitle"],["icon",""],["iconNode",""],["removeIcon",""],["downloadIcon",""],["downloadOrDelete",""],["preview",""],[1,"ant-upload-list-item-info"],[1,"ant-upload-span"],[3,"ngTemplateOutlet"],["class","ant-upload-list-item-actions",4,"ngIf"],["class","ant-upload-list-item-progress",4,"ngIf"],[3,"ngSwitch"],["class","ant-upload-list-item-thumbnail",3,"ant-upload-list-item-file",4,"ngSwitchCase"],["class","ant-upload-list-item-thumbnail","target","_blank","rel","noopener noreferrer",3,"ant-upload-list-item-file","href","click",4,"ngSwitchCase"],["class","ant-upload-text-icon",4,"ngSwitchDefault"],["noImageThumbTpl",""],[1,"ant-upload-list-item-thumbnail"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-thumbnail",3,"href","click"],["class","ant-upload-list-item-image",3,"src",4,"ngIf","ngIfElse"],[1,"ant-upload-list-item-image",3,"src"],[1,"ant-upload-text-icon"],[4,"ngIf","ngIfElse"],["customIconRender",""],["iconNodeFileIcon",""],[4,"ngSwitchCase"],["nz-icon","",3,"nzType",4,"ngSwitchDefault"],["nz-icon","","nzType","loading"],["nz-icon","",3,"nzType"],["nz-icon","","nzTheme","twotone",3,"nzType"],["type","button","nz-button","","nzType","text","nzSize","small","class","ant-upload-list-item-card-actions-btn",3,"click",4,"ngIf"],["type","button","nz-button","","nzType","text","nzSize","small",1,"ant-upload-list-item-card-actions-btn",3,"click"],["nz-icon","","nzType","delete"],["nz-icon","","nzType","download"],[3,"class",4,"ngIf"],["target","_blank","rel","noopener noreferrer","class","ant-upload-list-item-name",3,"href","click",4,"ngIf"],["class","ant-upload-list-item-name",3,"click",4,"ngIf"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-name",3,"href","click"],[1,"ant-upload-list-item-name",3,"click"],[1,"ant-upload-list-item-actions"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click",4,"ngIf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click"],["nz-icon","","nzType","eye"],[1,"ant-upload-list-item-progress"],["nzType","line",3,"nzPercent","nzShowInfo","nzStrokeWidth"]],template:function(t,e){1&t&&s.YNc(0,zt,20,14,"div",0),2&t&&s.Q6J("ngForOf",e.list)},directives:[z.sg,I.SY,z.tP,z.O5,z.RF,z.n9,z.ED,b.Ls,O.w,C.ix,z.PC,F.M],encapsulation:2,data:{animation:[(0,g.X$)("itemState",[(0,g.eR)(":enter",[(0,g.oB)({height:"0",width:"0",opacity:0}),(0,g.jt)(150,(0,g.oB)({height:"*",width:"*",opacity:1}))]),(0,g.eR)(":leave",[(0,g.jt)(150,(0,g.oB)({height:"0",width:"0",opacity:0}))])])]},changeDetection:0}),t})(),$t=(()=>{class t{constructor(t,e,n){this.cdr=t,this.i18n=e,this.directionality=n,this.destroy$=new c.xQ,this.dir="ltr",this.nzType="select",this.nzLimit=0,this.nzSize=0,this.nzDirectory=!1,this.nzOpenFileDialogOnClick=!0,this.nzFilter=[],this.nzFileList=[],this.nzDisabled=!1,this.nzListType="text",this.nzMultiple=!1,this.nzName="file",this._showUploadList=!0,this.nzShowButton=!0,this.nzWithCredentials=!1,this.nzIconRender=null,this.nzFileListRender=null,this.nzChange=new s.vpe,this.nzFileListChange=new s.vpe,this.onStart=t=>{this.nzFileList||(this.nzFileList=[]);const e=this.fileToObject(t);e.status="uploading",this.nzFileList=this.nzFileList.concat(e),this.nzFileListChange.emit(this.nzFileList),this.nzChange.emit({file:e,fileList:this.nzFileList,type:"start"}),this.detectChangesList()},this.onProgress=(t,e)=>{const n=this.getFileItem(e,this.nzFileList);n.percent=t.percent,this.nzChange.emit({event:t,file:Object.assign({},n),fileList:this.nzFileList,type:"progress"}),this.detectChangesList()},this.onSuccess=(t,e)=>{const n=this.nzFileList,i=this.getFileItem(e,n);i.status="done",i.response=t,this.nzChange.emit({file:Object.assign({},i),fileList:n,type:"success"}),this.detectChangesList()},this.onError=(t,e)=>{const n=this.nzFileList,i=this.getFileItem(e,n);i.error=t,i.status="error",this.nzChange.emit({file:Object.assign({},i),fileList:n,type:"error"}),this.detectChangesList()},this.onRemove=t=>{this.uploadComp.abort(t),t.status="removed";const e="function"==typeof this.nzRemove?this.nzRemove(t):null==this.nzRemove||this.nzRemove;(e instanceof a.y?e:(0,l.of)(e)).pipe((0,u.h)(t=>t)).subscribe(()=>{this.nzFileList=this.removeFileItem(t,this.nzFileList),this.nzChange.emit({file:t,fileList:this.nzFileList,type:"removed"}),this.nzFileListChange.emit(this.nzFileList),this.cdr.detectChanges()})},this.prefixCls="ant-upload",this.classList=[]}set nzShowUploadList(t){this._showUploadList="boolean"==typeof t?(0,x.sw)(t):t}get nzShowUploadList(){return this._showUploadList}zipOptions(){"boolean"==typeof this.nzShowUploadList&&this.nzShowUploadList&&(this.nzShowUploadList={showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!0});const t=this.nzFilter.slice();if(this.nzMultiple&&this.nzLimit>0&&-1===t.findIndex(t=>"limit"===t.name)&&t.push({name:"limit",fn:t=>t.slice(-this.nzLimit)}),this.nzSize>0&&-1===t.findIndex(t=>"size"===t.name)&&t.push({name:"size",fn:t=>t.filter(t=>t.size/1024<=this.nzSize)}),this.nzFileType&&this.nzFileType.length>0&&-1===t.findIndex(t=>"type"===t.name)){const e=this.nzFileType.split(",");t.push({name:"type",fn:t=>t.filter(t=>~e.indexOf(t.type))})}return this._btnOptions={disabled:this.nzDisabled,accept:this.nzAccept,action:this.nzAction,directory:this.nzDirectory,openFileDialogOnClick:this.nzOpenFileDialogOnClick,beforeUpload:this.nzBeforeUpload,customRequest:this.nzCustomRequest,data:this.nzData,headers:this.nzHeaders,name:this.nzName,multiple:this.nzMultiple,withCredentials:this.nzWithCredentials,filters:t,transformFile:this.nzTransformFile,onStart:this.onStart,onProgress:this.onProgress,onSuccess:this.onSuccess,onError:this.onError},this}fileToObject(t){return{lastModified:t.lastModified,lastModifiedDate:t.lastModifiedDate,name:t.filename||t.name,size:t.size,type:t.type,uid:t.uid,response:t.response,error:t.error,percent:0,originFileObj:t}}getFileItem(t,e){return e.filter(e=>e.uid===t.uid)[0]}removeFileItem(t,e){return e.filter(e=>e.uid!==t.uid)}fileDrop(t){t.type!==this.dragState&&(this.dragState=t.type,this.setClassMap())}detectChangesList(){var t;this.cdr.detectChanges(),null===(t=this.listComp)||void 0===t||t.detectChanges()}setClassMap(){let t=[];"drag"===this.nzType?(this.nzFileList.some(t=>"uploading"===t.status)&&t.push(`${this.prefixCls}-drag-uploading`),"dragover"===this.dragState&&t.push(`${this.prefixCls}-drag-hover`)):t=[`${this.prefixCls}-select-${this.nzListType}`],this.classList=[this.prefixCls,`${this.prefixCls}-${this.nzType}`,...t,this.nzDisabled&&`${this.prefixCls}-disabled`||"","rtl"===this.dir&&`${this.prefixCls}-rtl`||""].filter(t=>!!t),this.cdr.detectChanges()}ngOnInit(){var t;this.dir=this.directionality.value,null===(t=this.directionality.change)||void 0===t||t.pipe((0,h.R)(this.destroy$)).subscribe(t=>{this.dir=t,this.setClassMap(),this.cdr.detectChanges()}),this.i18n.localeChange.pipe((0,h.R)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Upload"),this.detectChangesList()})}ngOnChanges(){this.zipOptions().setClassMap()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(s.sBO),s.Y36(v.wi),s.Y36(y.Is,8))},t.\u0275cmp=s.Xpm({type:t,selectors:[["nz-upload"]],viewQuery:function(t,e){if(1&t&&(s.Gf(wt,5),s.Gf(yt,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.uploadComp=t.first),s.iGM(t=s.CRH())&&(e.listComp=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&s.ekj("ant-upload-picture-card-wrapper","picture-card"===e.nzListType)},inputs:{nzType:"nzType",nzLimit:"nzLimit",nzSize:"nzSize",nzDirectory:"nzDirectory",nzOpenFileDialogOnClick:"nzOpenFileDialogOnClick",nzFilter:"nzFilter",nzFileList:"nzFileList",nzDisabled:"nzDisabled",nzListType:"nzListType",nzMultiple:"nzMultiple",nzName:"nzName",nzShowButton:"nzShowButton",nzWithCredentials:"nzWithCredentials",nzIconRender:"nzIconRender",nzFileListRender:"nzFileListRender",nzShowUploadList:"nzShowUploadList",nzFileType:"nzFileType",nzAccept:"nzAccept",nzAction:"nzAction",nzBeforeUpload:"nzBeforeUpload",nzCustomRequest:"nzCustomRequest",nzData:"nzData",nzHeaders:"nzHeaders",nzRemove:"nzRemove",nzPreview:"nzPreview",nzPreviewFile:"nzPreviewFile",nzPreviewIsImage:"nzPreviewIsImage",nzTransformFile:"nzTransformFile",nzDownload:"nzDownload"},outputs:{nzChange:"nzChange",nzFileListChange:"nzFileListChange"},exportAs:["nzUpload"],features:[s.TTD],ngContentSelectors:N,decls:11,vars:2,consts:[["list",""],["con",""],["btn",""],[4,"ngIf","ngIfElse"],["select",""],["pic",""],[3,"display","locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir",4,"ngIf"],[4,"ngIf"],[3,"locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir"],["listComp",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["nz-upload-btn","",3,"options"],["uploadComp",""],[3,"ngTemplateOutlet"],[3,"ngClass","drop","dragover","dragleave"],["nz-upload-btn","",1,"ant-upload-btn",3,"options"],[1,"ant-upload-drag-container"]],template:function(t,e){if(1&t&&(s.F$t(),s.YNc(0,bt,2,2,"ng-template",null,0,s.W1O),s.YNc(2,Ft,1,0,"ng-template",null,1,s.W1O),s.YNc(4,Ot,4,5,"ng-template",null,2,s.W1O),s.YNc(6,Nt,7,4,"ng-container",3),s.YNc(7,Qt,1,2,"ng-template",null,4,s.W1O),s.YNc(9,Rt,2,2,"ng-template",null,5,s.W1O)),2&t){const t=s.MAs(8);s.xp6(6),s.Q6J("ngIf","drag"===e.nzType)("ngIfElse",t)}},directives:[z.O5,Zt,y.Lv,z.tP,z.mk,At],encapsulation:2,changeDetection:0}),(0,w.gn)([(0,x.Rn)()],t.prototype,"nzLimit",void 0),(0,w.gn)([(0,x.Rn)()],t.prototype,"nzSize",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzDirectory",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzOpenFileDialogOnClick",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzDisabled",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzMultiple",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzShowButton",void 0),(0,w.gn)([(0,x.yF)()],t.prototype,"nzWithCredentials",void 0),t})(),Pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[y.vT,z.ez,T.u5,m.ud,I.cg,F.W,v.YI,b.PV,C.sL]]}),t})()}}]);