import{c as Pe,d as xe}from"./chunk-7CKACTYS.js";import{$b as Y,Ab as Q,C as k,Cb as fe,Fa as ce,Fb as ue,H as A,Ia as p,Ja as l,Je as Z,Kb as ve,Ke as P,Lb as K,N as ee,Oa as le,Of as ke,Pc as ze,Rc as q,Ta as R,Tf as be,Ua as he,Va as V,Ve as W,Wa as M,Wf as De,X as te,Xa as D,Xf as Ee,Y as m,a as v,ba as ie,bb as F,bf as Ce,ca as ne,db as $,de as E,ea as b,eb as j,ec as we,fb as B,gb as h,ha as L,hb as f,ia as oe,ib as u,ja as se,l as I,le as ye,mb as O,oa as re,ob as me,pb as w,qb as pe,qf as Se,r as _,ra as z,rb as d,rf as Ie,sa as y,sb as de,tb as ge,vf as _e,wa as N,xa as ae,ya as H,yb as G,zb as U}from"./chunk-GLVUJKVB.js";var Ae=["imgRef"],Le=["imagePreviewWrapper"];function He(i,n){if(i&1){let s=O();h(0,"div",13),w("click",function(t){z(s);let o=d();return y(o.onSwitchLeft(t))}),u(1,"span",14),f(),h(2,"div",15),w("click",function(t){z(s);let o=d();return y(o.onSwitchRight(t))}),u(3,"span",16),f()}if(i&2){let s=d();D("ant-image-preview-switch-left-disabled",s.index<=0),p(2),D("ant-image-preview-switch-right-disabled",s.index>=s.images.length-1)}}function Ve(i,n){if(i&1&&(h(0,"li",5),fe(1),f()),i&2){let s=d();p(),ue("",s.index+1," / ",s.images.length,"")}}function $e(i,n){if(i&1){let s=O();h(0,"li",17),w("click",function(){let t=z(s).$implicit;return y(t.onClick())}),u(1,"span",18),f()}if(i&2){let s,e=n.$implicit,t=d();D("ant-image-preview-operations-operation-disabled",t.zoomOutDisabled&&e.type==="zoomOut"),p(),V("nzType",e.icon)("nzRotate",(s=e.rotate)!==null&&s!==void 0?s:0)}}function je(i,n){if(i&1&&u(0,"img",20,1),i&2){let s=d().$implicit,e=d();M("width",s.width)("height",s.height)("transform",e.previewImageTransform),he("src",e.sanitizerResourceUrl(s.src),ce)("srcset",s.srcset)("alt",s.alt)}}function Be(i,n){if(i&1&&R(0,je,2,9,"img",19),i&2){let s=n.$index,e=d();F(0,s===e.index?0:-1)}}var Ge=["*"];var Oe="image";function Ue(i){let n={};return i.width<=i.clientWidth&&i.height<=i.clientHeight&&(n={x:0,y:0}),(i.width>i.clientWidth||i.height>i.clientHeight)&&(n={x:Me(i.left,i.width,i.clientWidth),y:Me(i.top,i.height,i.clientHeight)}),n}function Qe(i){let n=i.getBoundingClientRect(),s=document.documentElement;return{left:n.left+(window.pageXOffset||s.scrollLeft)-(s.clientLeft||document.body.clientLeft||0),top:n.top+(window.pageYOffset||s.scrollTop)-(s.clientTop||document.body.clientTop||0)}}function Ke(){let i=document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return{width:i,height:n}}function Me(i,n,s){let e=i+n,t=(n-s)/2,o=null;return n>s?(i>0&&(o=t),i<0&&e<s&&(o=-t)):(i<0||e>s)&&(o=i<0?t:-t),o}var x=class{constructor(){this.nzKeyboard=!0,this.nzNoAnimation=!1,this.nzMaskClosable=!0,this.nzCloseOnNavigation=!0}},Fe={x:0,y:0},X=.5,Ye=1,qe=0,Ze=(()=>{let n=class n{get animationDisabled(){return this.config.nzNoAnimation??!1}get maskClosable(){let e=this.nzConfigService.getConfigForComponent(Oe)||{};return this.config.nzMaskClosable??e.nzMaskClosable??!0}constructor(e,t,o,r,c,a){this.ngZone=e,this.cdr=t,this.nzConfigService=o,this.config=r,this.destroy$=c,this.sanitizer=a,this._defaultNzZoom=Ye,this._defaultNzScaleStep=X,this._defaultNzRotate=qe,this.images=[],this.index=0,this.isDragging=!1,this.visible=!0,this.animationStateChanged=new H,this.scaleStepMap=new Map,this.previewImageTransform="",this.previewImageWrapperTransform="",this.operations=[{icon:"close",onClick:()=>{this.onClose()},type:"close"},{icon:"zoom-in",onClick:()=>{this.onZoomIn()},type:"zoomIn"},{icon:"zoom-out",onClick:()=>{this.onZoomOut()},type:"zoomOut"},{icon:"rotate-right",onClick:()=>{this.onRotateRight()},type:"rotateRight"},{icon:"rotate-left",onClick:()=>{this.onRotateLeft()},type:"rotateLeft"},{icon:"swap",onClick:()=>{this.onHorizontalFlip()},type:"flipHorizontally"},{icon:"swap",onClick:()=>{this.onVerticalFlip()},type:"flipVertically",rotate:90}],this.zoomOutDisabled=!1,this.position=v({},Fe),this.closeClick=new H,this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.flipHorizontally=this.config.nzFlipHorizontally??!1,this.flipVertically=this.config.nzFlipVertically??!1,this.updateZoomOutDisabled(),this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform()}ngOnInit(){this.ngZone.runOutsideAngular(()=>{k(this.imagePreviewWrapper.nativeElement,"mousedown").pipe(m(this.destroy$)).subscribe(()=>{this.isDragging=!0}),k(this.imagePreviewWrapper.nativeElement,"wheel").pipe(m(this.destroy$)).subscribe(e=>{this.ngZone.run(()=>this.wheelZoomEventHandler(e))})})}setImages(e,t){t&&(this.scaleStepMap=t),this.images=e,this.markForCheck()}switchTo(e){this.index=e,this.markForCheck()}next(){this.index<this.images.length-1&&(this.reset(),this.index++,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}prev(){this.index>0&&(this.reset(),this.index--,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}markForCheck(){this.cdr.markForCheck()}onClose(){this.visible=!1,this.closeClick.emit()}onZoomIn(){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom+=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled()}onZoomOut(){if(this.zoom>1){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom-=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.zoom<=1&&this.reCenterImage()}}onRotateRight(){this.rotate+=90,this.updatePreviewImageTransform()}onRotateLeft(){this.rotate-=90,this.updatePreviewImageTransform()}onSwitchLeft(e){e.preventDefault(),e.stopPropagation(),this.prev()}onSwitchRight(e){e.preventDefault(),e.stopPropagation(),this.next()}onHorizontalFlip(){this.flipHorizontally=!this.flipHorizontally,this.updatePreviewImageTransform()}onVerticalFlip(){this.flipVertically=!this.flipVertically,this.updatePreviewImageTransform()}wheelZoomEventHandler(e){e.preventDefault(),e.stopPropagation(),this.handlerImageTransformationWhileZoomingWithMouse(e,e.deltaY),this.handleImageScaleWhileZoomingWithMouse(e.deltaY),this.updatePreviewImageWrapperTransform(),this.updatePreviewImageTransform(),this.markForCheck()}onAnimationStart(e){this.animationStateChanged.emit(e)}onAnimationDone(e){this.animationStateChanged.emit(e)}onDragEnd(e){this.isDragging=!1;let t=this.imageRef.nativeElement.offsetWidth*this.zoom,o=this.imageRef.nativeElement.offsetHeight*this.zoom,{left:r,top:c}=Qe(this.imageRef.nativeElement),{width:a,height:g}=Ke(),T=this.rotate%180!==0,S=Ue({width:T?o:t,height:T?t:o,left:r,top:c,clientWidth:a,clientHeight:g});E(S.x)||E(S.y)?this.position=v(v({},this.position),S):!E(S.x)&&!E(S.y)&&(this.position={x:e.source.getFreeDragPosition().x,y:e.source.getFreeDragPosition().y})}sanitizerResourceUrl(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}updatePreviewImageTransform(){this.previewImageTransform=`scale3d(${this.zoom*(this.flipHorizontally?-1:1)}, ${this.zoom*(this.flipVertically?-1:1)}, 1) rotate(${this.rotate}deg)`}updatePreviewImageWrapperTransform(){this.previewImageWrapperTransform=`translate3d(${this.position.x}px, ${this.position.y}px, 0)`}updateZoomOutDisabled(){this.zoomOutDisabled=this.zoom<=1}handlerImageTransformationWhileZoomingWithMouse(e,t){let o,r=this.imageRef.nativeElement,a=getComputedStyle(r).transform.match(/matrix.*\((.+)\)/);a?o=+a[1].split(", ")[0]:o=this.zoom;let g=(e.clientX-r.getBoundingClientRect().x)/o,T=(e.clientY-r.getBoundingClientRect().y)/o,C=t<0?this.scaleStep/2:-this.scaleStep/2;this.position.x+=-g*C*2+r.offsetWidth*C,this.position.y+=-T*C*2+r.offsetHeight*C}handleImageScaleWhileZoomingWithMouse(e){this.isZoomedInWithMouseWheel(e)?this.onZoomIn():this.onZoomOut(),this.zoom<=1&&this.reCenterImage()}isZoomedInWithMouseWheel(e){return e<0}reset(){this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.flipHorizontally=!1,this.flipVertically=!1,this.reCenterImage()}reCenterImage(){this.position=v({},Fe)}};n.\u0275fac=function(t){return new(t||n)(l(le),l(Y),l(Z),l(x),l(W),l(ze))},n.\u0275cmp=L({type:n,selectors:[["nz-image-preview"]],viewQuery:function(t,o){if(t&1&&(G(Ae,5),G(Le,7)),t&2){let r;U(r=Q())&&(o.imageRef=r.first),U(r=Q())&&(o.imagePreviewWrapper=r.first)}},hostAttrs:[1,"ant-image-preview-root"],hostVars:6,hostBindings:function(t,o){t&1&&pe("@fadeMotion.start",function(c){return o.onAnimationStart(c)})("@fadeMotion.done",function(c){return o.onAnimationDone(c)}),t&2&&(me("@.disabled",o.config.nzNoAnimation)("@fadeMotion",o.visible?"enter":"leave"),M("z-index",o.config.nzZIndex),D("ant-image-preview-moving",o.isDragging))},exportAs:["nzImagePreview"],standalone:!0,features:[ve([W]),K],decls:17,vars:5,consts:[["imagePreviewWrapper",""],["imgRef",""],[1,"ant-image-preview-mask"],[1,"ant-image-preview-operations-wrapper"],[1,"ant-image-preview-operations"],[1,"ant-image-preview-operations-progress"],[1,"ant-image-preview-operations-operation",3,"ant-image-preview-operations-operation-disabled"],["tabindex","-1",1,"ant-image-preview-wrap",3,"click"],["role","dialog","aria-modal","true",1,"ant-image-preview"],["tabindex","0","aria-hidden","true",2,"width","0","height","0","overflow","hidden","outline","none"],[1,"ant-image-preview-content"],[1,"ant-image-preview-body"],["cdkDrag","",1,"ant-image-preview-img-wrapper",3,"cdkDragEnded","cdkDragFreeDragPosition"],[1,"ant-image-preview-switch-left",3,"click"],["nz-icon","","nzType","left","nzTheme","outline"],[1,"ant-image-preview-switch-right",3,"click"],["nz-icon","","nzType","right","nzTheme","outline"],[1,"ant-image-preview-operations-operation",3,"click"],["nz-icon","","nzTheme","outline",1,"ant-image-preview-operations-icon",3,"nzType","nzRotate"],["cdkDragHandle","",1,"ant-image-preview-img",3,"width","height","transform"],["cdkDragHandle","",1,"ant-image-preview-img"]],template:function(t,o){if(t&1){let r=O();u(0,"div",2),h(1,"div",3),R(2,He,4,4),h(3,"ul",4),R(4,Ve,2,2,"li",5),j(5,$e,2,4,"li",6,$),f()(),h(7,"div",7),w("click",function(a){return z(r),y(o.maskClosable&&a.target===a.currentTarget&&o.onClose())}),h(8,"div",8),u(9,"div",9),h(10,"div",10)(11,"div",11)(12,"div",12,0),w("cdkDragEnded",function(a){return z(r),y(o.onDragEnd(a))}),j(14,Be,1,1,null,null,$),f()()(),u(16,"div",9),f()()}t&2&&(p(2),F(2,o.images.length>1?2:-1),p(2),F(4,o.images.length>1?4:-1),p(),B(o.operations),p(7),M("transform",o.previewImageWrapperTransform),V("cdkDragFreeDragPosition",o.position),p(2),B(o.images))},dependencies:[Ie,Se,Pe,xe],encapsulation:2,data:{animation:[Ce]},changeDetection:0});let i=n;return i})(),J=class{constructor(n,s,e){this.previewInstance=n,this.config=s,this.overlayRef=e,this.destroy$=new I,e.keydownEvents().pipe(A(t=>this.config.nzKeyboard&&(t.keyCode===27||t.keyCode===37||t.keyCode===39)&&!_e(t))).subscribe(t=>{t.preventDefault(),t.keyCode===27&&n.onClose(),t.keyCode===37&&this.prev(),t.keyCode===39&&this.next()}),e.detachments().subscribe(()=>{this.overlayRef.dispose()}),n.closeClick.pipe(ee(1),te(()=>n.animationStateChanged),A(t=>t.phaseName==="done"),m(this.destroy$)).subscribe(()=>{this.close()})}switchTo(n){this.previewInstance.switchTo(n)}next(){this.previewInstance.next()}prev(){this.previewInstance.prev()}close(){this.destroy$.next(),this.overlayRef.dispose()}},We=(()=>{let n=class n{constructor(e,t,o,r){this.overlay=e,this.injector=t,this.nzConfigService=o,this.directionality=r}preview(e,t,o){return this.display(e,t,o)}display(e,t,o){let r=v(v({},new x),t??{}),c=this.createOverlay(r),a=this.attachPreviewComponent(c,r);a.setImages(e,o);let g=new J(a,r,c);return a.previewRef=g,g}attachPreviewComponent(e,t){let o=N.create({parent:this.injector,providers:[{provide:De,useValue:e},{provide:x,useValue:t}]}),r=new ke(Ze,null,o);return e.attach(r).instance}createOverlay(e){let t=this.nzConfigService.getConfigForComponent(Oe)||{},o=new be({scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:e.nzCloseOnNavigation??t.nzCloseOnNavigation??!0,direction:e.nzDirection||t.nzDirection||this.directionality.value});return this.overlay.create(o)}};n.\u0275fac=function(t){return new(t||n)(b(Ee),b(N),b(Z),b(q,8))},n.\u0275prov=ie({token:n,factory:n.\u0275fac});let i=n;return i})(),Xe=(()=>{let n=class n{constructor(){this.nzScaleStep=null,this.images=[]}addImage(e){this.images.push(e)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=L({type:n,selectors:[["nz-image-group"]],inputs:{nzScaleStep:"nzScaleStep"},exportAs:["nzImageGroup"],standalone:!0,features:[K],ngContentSelectors:Ge,decls:1,vars:0,template:function(t,o){t&1&&(de(),ge(0))},encapsulation:2,changeDetection:0});let i=n;return i})(),Je="image",Tt=(()=>{let n=class n{get previewable(){return!this.nzDisablePreview&&this.status!=="error"}constructor(e,t,o,r,c,a,g){this.document=e,this.nzConfigService=t,this.elementRef=o,this.nzImageService=r,this.cdr=c,this.parentGroup=a,this.directionality=g,this._nzModuleName=Je,this.nzSrc="",this.nzSrcset="",this.nzDisablePreview=!1,this.nzFallback=null,this.nzPlaceholder=null,this.nzScaleStep=null,this.status="normal",this.backLoadDestroy$=new I,this.destroy$=new I}ngOnInit(){this.backLoad(),this.parentGroup&&this.parentGroup.addImage(this),this.directionality&&(this.directionality.change?.pipe(m(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreview(){if(this.previewable)if(this.parentGroup){let e=this.parentGroup.images.filter(a=>a.previewable),t=e.map(a=>({src:a.nzSrc,srcset:a.nzSrcset})),o=e.findIndex(a=>this===a),r=new Map;e.forEach(a=>{r.set(a.nzSrc??a.nzSrcset,a.nzScaleStep??this.parentGroup.nzScaleStep??this.nzScaleStep??X)}),this.nzImageService.preview(t,{nzDirection:this.dir},r).switchTo(o)}else{let e=[{src:this.nzSrc,srcset:this.nzSrcset}];this.nzImageService.preview(e,{nzDirection:this.dir,nzScaleStep:this.nzScaleStep??X})}}getElement(){return this.elementRef}ngOnChanges(e){let{nzSrc:t}=e;t&&(this.getElement().nativeElement.src=t.currentValue,this.backLoad())}backLoad(){this.backLoadImage=this.document.createElement("img"),this.backLoadImage.src=this.nzSrc,this.backLoadImage.srcset=this.nzSrcset,this.status="loading",this.backLoadDestroy$.next(),this.backLoadDestroy$.complete(),this.backLoadDestroy$=new I,this.backLoadImage.complete?(this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset):(this.nzPlaceholder?(this.getElement().nativeElement.src=this.nzPlaceholder,this.getElement().nativeElement.srcset=""):(this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset),k(this.backLoadImage,"load").pipe(m(this.backLoadDestroy$),m(this.destroy$)).subscribe(()=>{this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset}),k(this.backLoadImage,"error").pipe(m(this.backLoadDestroy$),m(this.destroy$)).subscribe(()=>{this.status="error",this.nzFallback&&(this.getElement().nativeElement.src=this.nzFallback,this.getElement().nativeElement.srcset="")}))}};n.\u0275fac=function(t){return new(t||n)(l(we),l(Z),l(ae),l(We),l(Y),l(Xe,8),l(q,8))},n.\u0275dir=se({type:n,selectors:[["img","nz-image",""]],hostBindings:function(t,o){t&1&&w("click",function(){return o.onPreview()})},inputs:{nzSrc:"nzSrc",nzSrcset:"nzSrcset",nzDisablePreview:"nzDisablePreview",nzFallback:"nzFallback",nzPlaceholder:"nzPlaceholder",nzScaleStep:"nzScaleStep"},exportAs:["nzImage"],standalone:!0,features:[re]});let i=n;return _([ye(),P()],i.prototype,"nzDisablePreview",void 0),_([P()],i.prototype,"nzFallback",void 0),_([P()],i.prototype,"nzPlaceholder",void 0),_([P()],i.prototype,"nzScaleStep",void 0),i})(),Nt=(()=>{let n=class n{};n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=oe({type:n}),n.\u0275inj=ne({providers:[We],imports:[Ze]});let i=n;return i})();export{We as a,Xe as b,Tt as c,Nt as d};
