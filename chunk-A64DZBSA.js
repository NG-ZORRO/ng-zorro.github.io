import{a as Ve}from"./chunk-2OGLP7HT.js";import{a as U,b as Z}from"./chunk-FDSOWXMT.js";import{b as j,c as $}from"./chunk-WSU5OMEA.js";import{$f as E,Ab as K,B as Q,Da as ye,Db as k,E as fe,Ga as c,Ha as De,Ib as _e,Jb as Oe,Kb as Ie,Ma as M,N as he,Qf as ke,Re as V,Sb as we,T as ge,Tb as C,Te as R,U as Ce,V as ze,Va as W,Vc as Te,Xa as H,Xf as z,Y as a,aa as _,ab as s,ae as be,ba as O,bb as p,bc as T,c as le,cb as u,d as B,db as m,de as Fe,e as ce,fa as L,ga as Ee,ha as ve,ia as Me,jd as y,k as pe,kb as I,ke as A,le as Le,m as G,mb as N,mg as v,n as me,ob as w,oc as ee,pa as Ne,rh as P,sb as Y,tb as X,tc as Se,th as Ae,ub as J,w as ue,wd as xe,xd as te,ya as h,yb as S}from"./chunk-BKDXVBLI.js";import{a as r,b as ae}from"./chunk-DAQOROHW.js";function Ze(t,n){t&1&&(p(0,"div",0),m(1,"nz-spin"),u())}function qe(t,n){}function Be(t,n){if(t&1&&(p(0,"div",1),M(1,qe,0,0,"ng-template",2),u()),t&2){let e=w();h(),s("ngTemplateOutlet",e.nzToolkit)}}var D={UNLOAD:"unload",LOADING:"loading",LOADED:"LOADED"},oe="codeEditor";function ie(t){return(...n)=>{t&&t(...n)}}var ne=new ce(1),x=D.UNLOAD,Ge=(()=>{class t{nzConfigService=a(A);document=a(L);firstEditorInitialized=!1;option={};config;option$=new B(this.option);constructor(){let e=this.nzConfigService.getConfigForComponent(oe);this.config=r({},e),this.config.monacoEnvironment&&(this.document.defaultView.MonacoEnvironment=r({},this.config.monacoEnvironment)),this.option=this.config.defaultEditorOption||{},Le(oe,()=>{let o=this.nzConfigService.getConfigForComponent(oe);o&&this._updateDefaultOption(o.defaultEditorOption)})}_updateDefaultOption(e){this.option=r(r({},this.option),e),this.option$.next(this.option),"theme"in e&&e.theme&&monaco.editor.setTheme(e.theme)}requestToInit(){return x===D.LOADED?(this.onInit(),pe(this.getLatestOption())):(x===D.UNLOAD&&(this.config.useStaticLoading&&typeof monaco>"u"?te("You choose to use static loading but it seems that you forget to config webpack plugin correctly. Please refer to our official websitefor more details about static loading."):this.loadMonacoScript()),ne.pipe(he(()=>this.onInit()),G(()=>this.getLatestOption())))}loadMonacoScript(){if(this.config.useStaticLoading){Promise.resolve().then(()=>this.onLoad());return}if(x===D.LOADING)return;x=D.LOADING;let e=this.config.assetsRoot,o=e?`${e}/vs`:"assets/vs",i=window,d=this.document.createElement("script");d.type="text/javascript",d.src=`${o}/loader.js`;let g=()=>{se(),i.require.config(r({paths:{vs:o}},this.config.extraConfig)),i.require(["vs/editor/editor.main"],()=>{this.onLoad()})},de=()=>{throw se(),new Error(`${xe} cannot load assets of monaco editor from source "${o}".`)},se=()=>{d.removeEventListener("load",g),d.removeEventListener("error",de),this.document.documentElement.removeChild(d)};d.addEventListener("load",g),d.addEventListener("error",de),this.document.documentElement.appendChild(d)}onLoad(){x=D.LOADED,ne.next(!0),ne.complete(),ie(this.config.onLoad)()}onInit(){this.firstEditorInitialized||(this.firstEditorInitialized=!0,ie(this.config.onFirstEditorInit)()),ie(this.config.onInit)()}getLatestOption(){return r({},this.option)}static \u0275fac=function(o){return new(o||t)};static \u0275prov=Ce({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),l=(()=>{class t{nzCodeEditorService=a(Ge);ngZone=a(Me);platform=a(Te);destroyRef=a(Ee);nzEditorMode="normal";nzOriginalText="";nzLoading=!1;nzFullControl=!1;nzToolkit;set nzEditorOption(e){this.editorOption$.next(e)}nzEditorInitialized=new ve;editorOptionCached={};el=a(Ne).nativeElement;resize$=new le;editorOption$=new B({});editorInstance=null;value="";modelSet=!1;onDidChangeContentDisposable=null;constructor(){this.el.classList.add("ant-code-editor"),this.destroyRef.onDestroy(()=>{this.onDidChangeContentDisposable&&(this.onDidChangeContentDisposable.dispose(),this.onDidChangeContentDisposable=null),this.editorInstance&&(this.editorInstance.dispose(),this.editorInstance=null)})}ngAfterViewInit(){this.platform.isBrowser&&this.nzCodeEditorService.requestToInit().pipe(y(this.destroyRef)).subscribe(e=>this.setup(e))}writeValue(e){this.value=e,this.setValue()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouch=e}onChange=e=>{};onTouch=()=>{};layout(){this.resize$.next()}setup(e){this.ngZone.runOutsideAngular(()=>be().pipe(y(this.destroyRef)).subscribe(()=>{this.editorOptionCached=e,this.registerOptionChanges(),this.initMonacoEditorInstance(),this.registerResizeChange(),this.setValue(),this.nzFullControl||this.setValueEmitter(),this.nzEditorInitialized.observers.length&&this.ngZone.run(()=>this.nzEditorInitialized.emit(this.editorInstance))}))}registerOptionChanges(){me([this.editorOption$,this.nzCodeEditorService.option$]).pipe(y(this.destroyRef)).subscribe(([e,o])=>{this.editorOptionCached=r(r(r({},this.editorOptionCached),o),e),this.updateOptionToMonaco()})}initMonacoEditorInstance(){this.ngZone.runOutsideAngular(()=>{this.editorInstance=this.nzEditorMode==="normal"?monaco.editor.create(this.el,r({},this.editorOptionCached)):monaco.editor.createDiffEditor(this.el,r({},this.editorOptionCached))})}registerResizeChange(){Fe(window,"resize").pipe(Q(300),y(this.destroyRef)).subscribe(()=>{this.layout()}),this.resize$.pipe(y(this.destroyRef),ue(()=>!!this.editorInstance),G(()=>({width:this.el.clientWidth,height:this.el.clientHeight})),fe((e,o)=>e.width===o.width&&e.height===o.height),Q(50)).subscribe(()=>{this.editorInstance.layout()})}setValue(){if(this.editorInstance){if(this.nzFullControl&&this.value){te("should not set value when you are using full control mode! It would result in ambiguous data flow!");return}if(this.nzEditorMode==="normal")if(this.modelSet){let e=this.editorInstance.getModel();this.preservePositionAndSelections(()=>e.setValue(this.value))}else this.editorInstance.setModel(monaco.editor.createModel(this.value,this.editorOptionCached.language)),this.modelSet=!0;else if(this.modelSet){let e=this.editorInstance.getModel();this.preservePositionAndSelections(()=>{e.modified.setValue(this.value),e.original.setValue(this.nzOriginalText)})}else{let e=this.editorOptionCached.language;this.editorInstance.setModel({original:monaco.editor.createModel(this.nzOriginalText,e),modified:monaco.editor.createModel(this.value,e)}),this.modelSet=!0}}}preservePositionAndSelections(e){if(!this.editorInstance){e();return}let o=this.editorInstance.getPosition(),i=this.editorInstance.getSelections();e(),o&&this.editorInstance.setPosition(o),i&&this.editorInstance.setSelections(i)}setValueEmitter(){let e=this.nzEditorMode==="normal"?this.editorInstance.getModel():this.editorInstance.getModel().modified;this.onDidChangeContentDisposable=e.onDidChangeContent(()=>{this.emitValue(e.getValue())})}emitValue(e){this.value!==e&&(this.value=e,this.ngZone.run(()=>{this.onChange(e)}))}updateOptionToMonaco(){this.editorInstance&&this.editorInstance.updateOptions(r({},this.editorOptionCached))}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=c({type:t,selectors:[["nz-code-editor"]],inputs:{nzEditorMode:"nzEditorMode",nzOriginalText:"nzOriginalText",nzLoading:[2,"nzLoading","nzLoading",ee],nzFullControl:[2,"nzFullControl","nzFullControl",ee],nzToolkit:"nzToolkit",nzEditorOption:"nzEditorOption"},outputs:{nzEditorInitialized:"nzEditorInitialized"},exportAs:["nzCodeEditor"],features:[we([{provide:ke,useExisting:ge(()=>t),multi:!0}])],decls:2,vars:2,consts:[[1,"ant-code-editor-loading"],[1,"ant-code-editor-toolkit"],[3,"ngTemplateOutlet"]],template:function(o,i){o&1&&(W(0,Ze,2,0,"div",0),W(1,Be,2,1,"div",1)),o&2&&(H(i.nzLoading?0:-1),h(),H(i.nzToolkit?1:-1))},dependencies:[Ve,Se],encapsulation:2,changeDetection:0})}return t})(),f=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=De({type:t});static \u0275inj=ze({imports:[l]})}return t})();var Qe=()=>({language:"typescript"}),Re=class t{code=`import { NzCodeEditorModule } from 'ng-zorro-antd/code-editor'

@Component({})
export class SomeComponent {}`;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["nz-demo-code-editor-basic"]],decls:1,vars:3,consts:[[1,"editor",3,"ngModel","nzEditorOption"]],template:function(e,o){e&1&&m(0,"nz-code-editor",0),e&2&&s("ngModel",o.code)("nzEditorOption",C(2,Qe))},dependencies:[v,z,E,f,l],styles:[".editor[_ngcontent-%COMP%]{height:200px}"]})};var Xe=()=>({language:"javascript"});function Je(t,n){if(t&1){let e=I();p(0,"nz-icon",4),N("click",function(){_(e);let i=w();return O(i.toggleFullScreen())}),u()}if(t&2){let e=w();K("active",e.fullScreen),s("nzType",e.fullScreen?"fullscreen-exit":"fullscreen")}}var Pe=class t{editorComponent;tooltip;loading=!0;fullScreen=!1;code=`function flatten(arr) {
  if (!(arr instanceof Array)) {
    throw new Error('The parameter must be an array.');
  }

  function partial(arr_) {
    return arr_.reduce((previous, current) => {
      if (current instanceof Array) {
        previous.push(...partial(current));
        return previous;
      } else {
        previous.push(current);
        return previous;
      }
    }, []);
  }

  return partial(arr);
}

console.log(flatten(['1', 2, [[3]]]))`;document=a(L);renderer=a(ye);toggleFullScreen(){this.fullScreen=!this.fullScreen,this.renderer.setStyle(this.document.body,"overflow-y",this.fullScreen?"hidden":null),this.editorComponent?.layout(),this.tooltip?.hide()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["nz-demo-code-editor-complex"]],viewQuery:function(e,o){if(e&1&&(Y(l,5),Y(P,5)),e&2){let i;X(i=J())&&(o.editorComponent=i.first),X(i=J())&&(o.tooltip=i.first)}},decls:6,vars:8,consts:[["toolkit",""],["nz-paragraph","",2,"margin-bottom","8px"],[3,"ngModelChange","ngModel"],[1,"editor",3,"ngModel","nzLoading","nzToolkit","nzEditorOption"],["nz-tooltip","","nzTooltipTitle","Toggle Fullscreen",3,"click","nzType"]],template:function(e,o){if(e&1){let i=I();p(0,"p",1),k(1," Loading "),p(2,"nz-switch",2),Ie("ngModelChange",function(g){return _(i),Oe(o.loading,g)||(o.loading=g),O(g)}),u()(),m(3,"nz-code-editor",3),M(4,Je,1,3,"ng-template",null,0,T)}if(e&2){let i=S(5);h(2),_e("ngModel",o.loading),h(),K("full-screen",o.fullScreen),s("ngModel",o.code)("nzLoading",o.loading)("nzToolkit",i)("nzEditorOption",C(7,Xe))}},dependencies:[v,z,E,f,l,R,V,$,j,Z,U,Ae,P],styles:[".editor[_ngcontent-%COMP%]{height:200px}.full-screen[_ngcontent-%COMP%]{position:fixed;z-index:999;height:100vh;inset:0}"]})};var Ke=()=>({language:"markdown"});function et(t,n){t&1&&m(0,"nz-icon",5)}function tt(t,n){t&1&&m(0,"nz-icon",6)}var je=class t{nzConfigService=a(A);dark=!1;code=`**All monaco editor instances on the same page always have the same color. It's a by-design of monaco editor.**

You can refer to [this issue](https://github.com/Microsoft/monaco-editor/issues/338).`;onDarkModeChange(n){this.dark=n;let e=this.nzConfigService.getConfigForComponent("codeEditor")?.defaultEditorOption||{};this.nzConfigService.set("codeEditor",{defaultEditorOption:ae(r({},e),{theme:n?"vs-dark":"vs"})})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["nz-demo-code-editor-config"]],decls:8,vars:6,consts:[["unchecked",""],["checked",""],["nz-paragraph","",2,"margin-bottom","8px"],[3,"ngModelChange","ngModel","nzUnCheckedChildren","nzCheckedChildren"],[2,"height","200px",3,"ngModel","nzEditorOption"],["nzType","bulb"],["nzType","poweroff"]],template:function(e,o){if(e&1){let i=I();p(0,"p",2),k(1," Change Theme "),p(2,"nz-switch",3),N("ngModelChange",function(g){return _(i),O(o.onDarkModeChange(g))}),u()(),M(3,et,1,0,"ng-template",null,0,T)(5,tt,1,0,"ng-template",null,1,T),m(7,"nz-code-editor",4)}if(e&2){let i=S(4),d=S(6);h(2),s("ngModel",o.dark)("nzUnCheckedChildren",i)("nzCheckedChildren",d),h(5),s("ngModel",o.code)("nzEditorOption",C(5,Ke))}},dependencies:[v,z,E,f,l,R,V,Z,U,$,j],encapsulation:2})};var ot=()=>({language:"typescript"}),$e=class t{originalCode=`import { NzCodeEditorModule } from 'ng-zorro-antd/code-editor';

@Component({})
export class SomeComponent {}`;code=`import { NzCodeEditorModule } from 'ng-zorro-antd/code-editor';

@Component({})
export class SomeComponent {}`;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["nz-demo-code-editor-diff"]],decls:1,vars:5,consts:[[1,"editor",3,"nzOriginalText","nzEditorMode","ngModel","nzEditorOption"]],template:function(e,o){e&1&&m(0,"nz-code-editor",0),e&2&&s("nzOriginalText",o.originalCode)("nzEditorMode","diff")("ngModel",o.code)("nzEditorOption",C(4,ot))},dependencies:[v,z,E,f,l],styles:[".editor[_ngcontent-%COMP%]{height:200px}"]})};var Ue=class t{editor;onEditorInit(n){this.editor=n,this.editor.setModel(monaco.editor.createModel("console.log('Hello ng-zorro-antd')","typescript"))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["nz-demo-code-editor-full-control"]],decls:1,vars:1,consts:[[1,"editor",3,"nzEditorInitialized","nzFullControl"]],template:function(e,o){e&1&&(p(0,"nz-code-editor",0),N("nzEditorInitialized",function(d){return o.onEditorInit(d)}),u()),e&2&&s("nzFullControl",!0)},dependencies:[f,l],styles:[".editor[_ngcontent-%COMP%]{height:200px}"]})};export{Re as a,Pe as b,je as c,$e as d,Ue as e};
