import{k as Le,l as Ze}from"./chunk-MFM2NZ5P.js";import{$a as J,Ab as E,Bd as x,C as pe,Db as Ie,Ga as K,Gb as ke,Ha as we,Ia as _e,M,Of as Te,Pg as Ne,Qa as ye,Rc as Pe,Se as Ee,Tc as oe,U as de,Ue as xe,Ug as Re,V as ge,Va as L,Xa as Z,Y as s,Za as q,_a as X,_g as Fe,aa as k,ab as ee,ah as Me,ba as D,bb as d,bh as Oe,c as F,cb as _,db as y,ea as U,ee as T,fa as B,ga as Q,ha as fe,he as ae,i as P,ia as ue,j as f,ja as O,kb as W,kd as I,le as V,m as $,mb as b,na as ve,nc as ne,ne as N,ob as v,pa as Y,pb as Ce,pc as De,qb as Se,r as j,sb as be,tb as te,u as he,ua as ze,ub as ie,w as G,ya as u,zb as A}from"./chunk-HVHL7L73.js";import{a as S}from"./chunk-DAQOROHW.js";var Be=["*"],Qe=["imgRef"],Ye=["imagePreviewWrapper"];function Ke(t,r){if(t&1){let e=W();d(0,"div",13),b("click",function(n){k(e);let o=v();return D(o.onSwitchLeft(n))}),y(1,"nz-icon",14),_(),d(2,"div",15),b("click",function(n){k(e);let o=v();return D(o.onSwitchRight(n))}),y(3,"nz-icon",16),_()}if(t&2){let e=v();E("ant-image-preview-switch-left-disabled",e.index<=0),u(2),E("ant-image-preview-switch-right-disabled",e.index>=e.images.length-1)}}function qe(t,r){if(t&1&&(d(0,"li",5),Ie(1),_()),t&2){let e=v();u(),ke("",e.index+1," / ",e.images.length)}}function Xe(t,r){if(t&1){let e=W();d(0,"li",17),b("click",function(){let n=k(e).$implicit;return D(n.onClick())}),y(1,"nz-icon",18),_()}if(t&2){let e=r.$implicit,i=v();E("ant-image-preview-operations-operation-disabled",i.zoomOutDisabled&&e.type==="zoomOut"),u(),ee("nzType",e.icon)("nzRotate",e.rotate??0)}}function Je(t,r){if(t&1&&y(0,"img",20,1),t&2){let e=v().$implicit,i=v();A("width",e.width)("height",e.height)("transform",i.previewImageTransform()),ye("src",i.sanitizerResourceUrl(e.src),ze)("srcset",e.srcset)("alt",e.alt)}}function et(t,r){if(t&1&&L(0,Je,2,9,"img",19),t&2){let e=r.$index,i=v();Z(e===i.index?0:-1)}}var tt=(()=>{class t{nzScaleStep=null;images=[];addImage(e){this.images.push(e)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=K({type:t,selectors:[["nz-image-group"]],inputs:{nzScaleStep:"nzScaleStep"},exportAs:["nzImageGroup"],ngContentSelectors:Be,decls:1,vars:0,template:function(i,n){i&1&&(Ce(),Se(0))},encapsulation:2,changeDetection:0})}return t})(),je="image",R=class{nzKeyboard=!0;nzNoAnimation=!1;nzMaskClosable=!0;nzCloseOnNavigation=!0;nzZIndex;nzZoom;nzRotate;nzFlipHorizontally;nzFlipVertically;nzScaleStep;nzDirection};function it(t){let r={};return t.width<=t.clientWidth&&t.height<=t.clientHeight&&(r={x:0,y:0}),(t.width>t.clientWidth||t.height>t.clientHeight)&&(r={x:Ve(t.left,t.width,t.clientWidth),y:Ve(t.top,t.height,t.clientHeight)}),r}function nt(t){let r=t.getBoundingClientRect(),e=document.documentElement;return{left:r.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||document.body.clientLeft||0),top:r.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||document.body.clientTop||0)}}function ot(){let t=document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return{width:t,height:r}}function Ve(t,r,e){let i=t+r,n=(r-e)/2,o=null;return r>e?(t>0&&(o=n),t<0&&i<e&&(o=-n)):(t<0||i>e)&&(o=t<0?n:-n),o}var He={x:0,y:0},le=.5,at=1,rt=0,Ge=(()=>{class t{document=s(B);ngZone=s(ue);cdr=s(ne);nzConfigService=s(V);sanitizer=s(Pe);destroyRef=s(Q);elementRef=s(Y);config=s(R);_defaultNzZoom=at;_defaultNzScaleStep=le;_defaultNzRotate=rt;isDragging=O(!1);images=[];index=0;visible=!0;scaleStepMap=new Map;previewImageTransform=O("");previewImageWrapperTransform=O("");operations=[{icon:"close",onClick:()=>{this.onClose()},type:"close"},{icon:"zoom-in",onClick:()=>{this.onZoomIn()},type:"zoomIn"},{icon:"zoom-out",onClick:()=>{this.onZoomOut()},type:"zoomOut"},{icon:"rotate-right",onClick:()=>{this.onRotateRight()},type:"rotateRight"},{icon:"rotate-left",onClick:()=>{this.onRotateLeft()},type:"rotateLeft"},{icon:"swap",onClick:()=>{this.onHorizontalFlip()},type:"flipHorizontally"},{icon:"swap",onClick:()=>{this.onVerticalFlip()},type:"flipVertically",rotate:90}];zoomOutDisabled=!1;position=S({},He);previewRef;closeClick=new fe;imageRef;imagePreviewWrapper;zoom=this.config.nzZoom??this._defaultNzZoom;rotate=this.config.nzRotate??this._defaultNzRotate;scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep;flipHorizontally=this.config.nzFlipHorizontally??!1;flipVertically=this.config.nzFlipVertically??!1;get maskClosable(){let e=this.nzConfigService.getConfigForComponent(je)||{};return this.config.nzMaskClosable??e.nzMaskClosable??!0}constructor(){this.updateZoomOutDisabled(),this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform()}ngOnInit(){he(T(this.imagePreviewWrapper.nativeElement,"mousedown").pipe($(()=>!0)),T(this.imagePreviewWrapper.nativeElement,"mouseup").pipe($(()=>!1))).pipe(I(this.destroyRef)).subscribe(e=>this.isDragging.set(e)),T(this.imagePreviewWrapper.nativeElement,"wheel").pipe(I(this.destroyRef)).subscribe(e=>{this.ngZone.run(()=>this.wheelZoomEventHandler(e))}),T(this.document,"keydown").pipe(G(e=>e.keyCode===27),I(this.destroyRef)).subscribe(()=>{this.ngZone.run(()=>{this.onClose(),this.markForCheck()})})}setImages(e,i){i&&(this.scaleStepMap=i),this.images=e,this.markForCheck()}switchTo(e){this.index=e,this.markForCheck()}next(){this.index<this.images.length-1&&(this.reset(),this.index++,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}prev(){this.index>0&&(this.reset(),this.index--,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}markForCheck(){this.cdr.markForCheck()}onClose(){this.visible=!1,this.closeClick.emit()}onZoomIn(){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom+=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled()}onZoomOut(){if(this.zoom>1){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom-=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.zoom<=1&&this.reCenterImage()}}onRotateRight(){this.rotate+=90,this.updatePreviewImageTransform()}onRotateLeft(){this.rotate-=90,this.updatePreviewImageTransform()}onSwitchLeft(e){e.preventDefault(),e.stopPropagation(),this.prev()}onSwitchRight(e){e.preventDefault(),e.stopPropagation(),this.next()}onHorizontalFlip(){this.flipHorizontally=!this.flipHorizontally,this.updatePreviewImageTransform()}onVerticalFlip(){this.flipVertically=!this.flipVertically,this.updatePreviewImageTransform()}wheelZoomEventHandler(e){e.preventDefault(),e.stopPropagation(),this.handlerImageTransformationWhileZoomingWithMouse(e,e.deltaY),this.handleImageScaleWhileZoomingWithMouse(e.deltaY),this.updatePreviewImageWrapperTransform(),this.updatePreviewImageTransform(),this.markForCheck()}onDragEnd(e){this.isDragging.set(!1);let i=this.imageRef.nativeElement.offsetWidth*this.zoom,n=this.imageRef.nativeElement.offsetHeight*this.zoom,{left:o,top:m}=nt(this.imageRef.nativeElement),{width:c,height:g}=ot(),C=this.rotate%180!==0,w=it({width:C?n:i,height:C?i:n,left:o,top:m,clientWidth:c,clientHeight:g});x(w.x)||x(w.y)?this.position=S(S({},this.position),w):!x(w.x)&&!x(w.y)&&(this.position={x:e.source.getFreeDragPosition().x,y:e.source.getFreeDragPosition().y})}sanitizerResourceUrl(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}updatePreviewImageTransform(){this.previewImageTransform.set(`scale3d(${this.zoom*(this.flipHorizontally?-1:1)}, ${this.zoom*(this.flipVertically?-1:1)}, 1) rotate(${this.rotate}deg)`)}updatePreviewImageWrapperTransform(){this.previewImageWrapperTransform.set(`translate3d(${this.position.x}px, ${this.position.y}px, 0)`)}updateZoomOutDisabled(){this.zoomOutDisabled=this.zoom<=1}handlerImageTransformationWhileZoomingWithMouse(e,i){let n,o=this.imageRef.nativeElement,c=getComputedStyle(o).transform.match(/matrix.*\((.+)\)/);c?n=+c[1].split(", ")[0]:n=this.zoom;let g=(e.clientX-o.getBoundingClientRect().x)/n,C=(e.clientY-o.getBoundingClientRect().y)/n,z=i<0?this.scaleStep/2:-this.scaleStep/2;this.position.x+=-g*z*2+o.offsetWidth*z,this.position.y+=-C*z*2+o.offsetHeight*z}handleImageScaleWhileZoomingWithMouse(e){this.isZoomedInWithMouseWheel(e)?this.onZoomIn():this.onZoomOut(),this.zoom<=1&&this.reCenterImage()}isZoomedInWithMouseWheel(e){return e<0}reset(){this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.flipHorizontally=!1,this.flipVertically=!1,this.reCenterImage()}reCenterImage(){this.position=S({},He)}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=K({type:t,selectors:[["nz-image-preview"]],viewQuery:function(i,n){if(i&1&&be(Qe,5)(Ye,7),i&2){let o;te(o=ie())&&(n.imageRef=o.first),te(o=ie())&&(n.imagePreviewWrapper=o.first)}},hostAttrs:[1,"ant-image-preview-root"],hostVars:4,hostBindings:function(i,n){i&2&&(A("z-index",n.config.nzZIndex),E("ant-image-preview-moving",n.isDragging()))},exportAs:["nzImagePreview"],decls:17,vars:5,consts:[["imagePreviewWrapper",""],["imgRef",""],[1,"ant-image-preview-mask"],[1,"ant-image-preview-operations-wrapper"],[1,"ant-image-preview-operations"],[1,"ant-image-preview-operations-progress"],[1,"ant-image-preview-operations-operation",3,"ant-image-preview-operations-operation-disabled"],["tabindex","-1",1,"ant-image-preview-wrap",3,"click"],["role","dialog","aria-modal","true",1,"ant-image-preview"],["tabindex","0","aria-hidden","true",1,"ant-image-preview-focus-trap"],[1,"ant-image-preview-content"],[1,"ant-image-preview-body"],["cdkDrag","",1,"ant-image-preview-img-wrapper",3,"cdkDragEnded","cdkDragFreeDragPosition"],[1,"ant-image-preview-switch-left",3,"click"],["nzType","left","nzTheme","outline"],[1,"ant-image-preview-switch-right",3,"click"],["nzType","right","nzTheme","outline"],[1,"ant-image-preview-operations-operation",3,"click"],["nzTheme","outline",1,"ant-image-preview-operations-icon",3,"nzType","nzRotate"],["cdkDragHandle","",1,"ant-image-preview-img",3,"width","height","transform"],["cdkDragHandle","",1,"ant-image-preview-img"]],template:function(i,n){if(i&1){let o=W();y(0,"div",2),d(1,"div",3),L(2,Ke,4,4),d(3,"ul",4),L(4,qe,2,2,"li",5),X(5,Xe,2,4,"li",6,q),_()(),d(7,"div",7),b("click",function(c){return k(o),D(n.maskClosable&&c.target===c.currentTarget&&n.onClose())}),d(8,"div",8),y(9,"div",9),d(10,"div",10)(11,"div",11)(12,"div",12,0),b("cdkDragEnded",function(c){return k(o),D(n.onDragEnd(c))}),X(14,et,1,1,null,null,q),_()()(),y(16,"div",9),_()()}i&2&&(u(2),Z(n.images.length>1?2:-1),u(2),Z(n.images.length>1?4:-1),u(),J(n.operations),u(7),A("transform",n.previewImageWrapperTransform()),ee("cdkDragFreeDragPosition",n.position),u(2),J(n.images))},dependencies:[xe,Ee,Le,Ze],encapsulation:2,changeDetection:0})}return t})(),$e="ant-image-preview",re={enter:ae($e,"fade-motion-enter"),leave:ae($e,"fade-motion-leave")},st="antFadeOut",ce=class{previewInstance;config;overlayRef;destroy$=new F;constructor(r,e,i){this.previewInstance=r,this.config=e,this.overlayRef=i,e.nzKeyboard&&i.keydownEvents().pipe(G(n=>(n.keyCode===27||n.keyCode===37||n.keyCode===39)&&!Te(n))).subscribe(n=>{n.preventDefault(),n.keyCode===27&&r.onClose(),n.keyCode===37&&this.prev(),n.keyCode===39&&this.next()}),i.detachments().subscribe(()=>this.overlayRef.dispose()),r.closeClick.pipe(pe(1),M(this.destroy$)).subscribe(()=>this.close()),this._startEnterAnimation()}get element(){return this.previewInstance.elementRef.nativeElement}get _animationsEnabled(){return!(this.config.nzNoAnimation??!1)}_startEnterAnimation(){this._animationsEnabled&&this.element.classList.add(re.enter)}_startLeaveAnimation(){this._animationsEnabled&&(this.element.classList.remove(re.enter),this.element.classList.add(re.leave))}switchTo(r){this.previewInstance.switchTo(r)}next(){this.previewInstance.next()}prev(){this.previewInstance.prev()}close(){if(this._animationsEnabled){let r=e=>{e.animationName===st&&(this.element.removeEventListener("animationend",r),this._doClose())};this.element.addEventListener("animationend",r),this._startLeaveAnimation()}else this._doClose()}_doClose(){this.destroy$.next(),this.overlayRef.dispose(),this.previewInstance=null}},Ue=(()=>{class t{injector=s(U);nzConfigService=s(V);directionality=s(oe);preview(e,i,n){return this.display(e,i,n)}display(e,i,n){let o=S(S({},new R),i??{}),m=this.createOverlay(o),c=this.attachPreviewComponent(m,o);c.setImages(e,n);let g=new ce(c,o,m);return c.previewRef=g,g}attachPreviewComponent(e,i){let n=U.create({parent:this.injector,providers:[{provide:Fe,useValue:e},{provide:R,useValue:i}]}),o=new Ne(Ge,null,n);return e.attach(o).instance}createOverlay(e){let i=this.nzConfigService.getConfigForComponent(je)||{};return Oe(this.injector,{scrollStrategy:Re(this.injector),positionStrategy:Me(this.injector),disposeOnNavigation:e.nzCloseOnNavigation??i.nzCloseOnNavigation??!0,direction:e.nzDirection||i.nzDirection||this.directionality.value})}static \u0275fac=function(i){return new(i||t)};static \u0275prov=de({token:t,factory:t.\u0275fac})}return t})(),lt="image",Ft=(()=>{let t,r=[],e=[],i,n=[],o=[],m,c=[],g=[],C,z=[],w=[];return class me{static{let l=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;t=[N()],i=[N()],m=[N()],C=[N()],P(null,null,t,{kind:"field",name:"nzDisablePreview",static:!1,private:!1,access:{has:a=>"nzDisablePreview"in a,get:a=>a.nzDisablePreview,set:(a,h)=>{a.nzDisablePreview=h}},metadata:l},r,e),P(null,null,i,{kind:"field",name:"nzFallback",static:!1,private:!1,access:{has:a=>"nzFallback"in a,get:a=>a.nzFallback,set:(a,h)=>{a.nzFallback=h}},metadata:l},n,o),P(null,null,m,{kind:"field",name:"nzPlaceholder",static:!1,private:!1,access:{has:a=>"nzPlaceholder"in a,get:a=>a.nzPlaceholder,set:(a,h)=>{a.nzPlaceholder=h}},metadata:l},c,g),P(null,null,C,{kind:"field",name:"nzScaleStep",static:!1,private:!1,access:{has:a=>"nzScaleStep"in a,get:a=>a.nzScaleStep,set:(a,h)=>{a.nzScaleStep=h}},metadata:l},z,w),l&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l})}document=s(B);nzConfigService=s(V);elementRef=s(Y);nzImageService=s(Ue);cdr=s(ne);directionality=s(oe);destroyRef=s(Q);_nzModuleName=lt;nzSrc="";nzSrcset="";nzDisablePreview=f(this,r,!1);nzFallback=(f(this,e),f(this,n,null));nzPlaceholder=(f(this,o),f(this,c,null));nzScaleStep=(f(this,g),f(this,z,null));dir=f(this,w);backLoadImage;status="normal";backLoadDestroy$=new F;parentGroup=s(tt,{optional:!0});get previewable(){return!this.nzDisablePreview&&this.status!=="error"}ngOnInit(){this.backLoad(),this.parentGroup&&this.parentGroup.addImage(this),this.directionality&&(this.directionality.change?.pipe(I(this.destroyRef)).subscribe(l=>{this.dir=l,this.cdr.detectChanges()}),this.dir=this.directionality.value)}onPreview(){if(this.previewable)if(this.parentGroup){let l=this.parentGroup.images.filter(p=>p.previewable),a=l.map(p=>({src:p.nzSrc,srcset:p.nzSrcset})),h=l.findIndex(p=>this===p),H=new Map;l.forEach(p=>{H.set(p.nzSrc??p.nzSrcset,p.nzScaleStep??this.parentGroup.nzScaleStep??this.nzScaleStep??le)}),this.nzImageService.preview(a,{nzDirection:this.dir},H).switchTo(h)}else{let l=[{src:this.nzSrc,srcset:this.nzSrcset}];this.nzImageService.preview(l,{nzDirection:this.dir,nzScaleStep:this.nzScaleStep??le})}}getElement(){return this.elementRef}ngOnChanges(l){let{nzSrc:a}=l;a&&(this.getElement().nativeElement.src=a.currentValue,this.backLoad())}backLoad(){this.backLoadImage=this.document.createElement("img"),this.backLoadImage.src=this.nzSrc,this.backLoadImage.srcset=this.nzSrcset,this.status="loading",this.backLoadDestroy$.next(),this.backLoadDestroy$.complete(),this.backLoadDestroy$=new F,this.backLoadImage.complete?(this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset):(this.nzPlaceholder?(this.getElement().nativeElement.src=this.nzPlaceholder,this.getElement().nativeElement.srcset=""):(this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset),j(this.backLoadImage,"load").pipe(M(this.backLoadDestroy$),I(this.destroyRef)).subscribe(()=>{this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset}),j(this.backLoadImage,"error").pipe(M(this.backLoadDestroy$),I(this.destroyRef)).subscribe(()=>{this.status="error",this.nzFallback&&(this.getElement().nativeElement.src=this.nzFallback,this.getElement().nativeElement.srcset="")}))}static \u0275fac=function(a){return new(a||me)};static \u0275dir=_e({type:me,selectors:[["img","nz-image",""]],hostBindings:function(a,h){a&1&&b("click",function(){return h.onPreview()})},inputs:{nzSrc:"nzSrc",nzSrcset:"nzSrcset",nzDisablePreview:[2,"nzDisablePreview","nzDisablePreview",De],nzFallback:"nzFallback",nzPlaceholder:"nzPlaceholder",nzScaleStep:"nzScaleStep"},exportAs:["nzImage"],features:[ve]})}})(),Mt=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=we({type:t});static \u0275inj=ge({providers:[Ue],imports:[Ge]})}return t})();export{tt as a,Ue as b,Ft as c,Mt as d};
